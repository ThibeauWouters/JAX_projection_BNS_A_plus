Thu Apr  3 16:32:21 CEST 2025
NVIDIA H100
GPU found?
[CudaDevice(id=0)]
GPU found?
[CudaDevice(id=0)]
Ignoring the Q and Z NEP parameters
Using CSE grid with 8 points
Fixed params loaded inside the MicroToMacroTransform:
    E_sat: -16.0
Given id_list was None, so created id list [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26 27 28 29 30]
Loading the trained NF model from: models/jester_hard/Aplus/1
Loaded the NF for run jester_hard_1
The range of m1 for jester_hard_1 is: 1.7465119808912277 to 2.3622963577508926
The range of m2 for jester_hard_1 is: 1.2045315653085709 to 1.5910588949918747
Loading the trained NF model from: models/jester_hard/Aplus/2
Loaded the NF for run jester_hard_2
The range of m1 for jester_hard_2 is: 1.814965233206749 to 2.3711102455854416
The range of m2 for jester_hard_2 is: 1.4201939851045609 to 1.8279214948415756
Loading the trained NF model from: models/jester_hard/Aplus/3
Loaded the NF for run jester_hard_3
The range of m1 for jester_hard_3 is: 1.9702450186014175 to 2.3298730701208115
The range of m2 for jester_hard_3 is: 1.7432858794927597 to 2.0543528348207474
Loading the trained NF model from: models/jester_hard/Aplus/4
Loaded the NF for run jester_hard_4
The range of m1 for jester_hard_4 is: 1.841561421751976 to 2.2119949012994766
The range of m2 for jester_hard_4 is: 1.5665366500616074 to 1.8705197423696518
Loading the trained NF model from: models/jester_hard/Aplus/5
Loaded the NF for run jester_hard_5
The range of m1 for jester_hard_5 is: 1.4936184138059616 to 1.8181998282670975
The range of m2 for jester_hard_5 is: 1.2342091649770737 to 1.4972759038209915
Loading the trained NF model from: models/jester_hard/Aplus/6
Loaded the NF for run jester_hard_6
The range of m1 for jester_hard_6 is: 1.8313641101121902 to 2.2880829125642776
The range of m2 for jester_hard_6 is: 1.4760550111532211 to 1.8167086690664291
Loading the trained NF model from: models/jester_hard/Aplus/7
Loaded the NF for run jester_hard_7
The range of m1 for jester_hard_7 is: 2.050231024622917 to 2.43766225874424
The range of m2 for jester_hard_7 is: 1.7554452270269394 to 2.0873714238405228
Loading the trained NF model from: models/jester_hard/Aplus/8
Loaded the NF for run jester_hard_8
The range of m1 for jester_hard_8 is: 1.920502409338951 to 2.3103324323892593
The range of m2 for jester_hard_8 is: 1.6033486276865005 to 1.9157945364713669
Loading the trained NF model from: models/jester_hard/Aplus/9
Loaded the NF for run jester_hard_9
The range of m1 for jester_hard_9 is: 1.5325210243463516 to 1.8213678151369095
The range of m2 for jester_hard_9 is: 1.3025472313165665 to 1.54096819460392
Loading the trained NF model from: models/jester_hard/Aplus/10
Loaded the NF for run jester_hard_10
The range of m1 for jester_hard_10 is: 2.0645999163389206 to 2.4422255903482437
The range of m2 for jester_hard_10 is: 1.7474835366010666 to 2.065040245652199
Loading the trained NF model from: models/jester_hard/Aplus/11
Loaded the NF for run jester_hard_11
The range of m1 for jester_hard_11 is: 1.6571005433797836 to 2.253212109208107
The range of m2 for jester_hard_11 is: 1.2311486154794693 to 1.639464870095253
Loading the trained NF model from: models/jester_hard/Aplus/12
Loaded the NF for run jester_hard_12
The range of m1 for jester_hard_12 is: 1.1529163271188736 to 1.36446975171566
The range of m2 for jester_hard_12 is: 0.9735127538442612 to 1.150006279349327
Loading the trained NF model from: models/jester_hard/Aplus/13
Loaded the NF for run jester_hard_13
The range of m1 for jester_hard_13 is: 1.9008948653936386 to 2.468802109360695
The range of m2 for jester_hard_13 is: 1.2721935659646988 to 1.625615581870079
Loading the trained NF model from: models/jester_hard/Aplus/14
Loaded the NF for run jester_hard_14
The range of m1 for jester_hard_14 is: 1.6096246987581253 to 2.0193731039762497
The range of m2 for jester_hard_14 is: 1.2899405509233475 to 1.6061829775571823
Loading the trained NF model from: models/jester_hard/Aplus/15
Loaded the NF for run jester_hard_15
The range of m1 for jester_hard_15 is: 1.5470882505178452 to 1.884106770157814
The range of m2 for jester_hard_15 is: 1.2946134060621262 to 1.5632084757089615
Loading the trained NF model from: models/jester_hard/Aplus/16
Loaded the NF for run jester_hard_16
The range of m1 for jester_hard_16 is: 1.3126174360513687 to 1.5244395285844803
The range of m2 for jester_hard_16 is: 1.1614318937063217 to 1.349821612238884
Loading the trained NF model from: models/jester_hard/Aplus/17
Loaded the NF for run jester_hard_17
The range of m1 for jester_hard_17 is: 1.8562886863946915 to 2.2426820546388626
The range of m2 for jester_hard_17 is: 0.9395141154527664 to 1.1080893129110336
Loading the trained NF model from: models/jester_hard/Aplus/18
Loaded the NF for run jester_hard_18
The range of m1 for jester_hard_18 is: 1.3985108584165573 to 1.7225342243909836
The range of m2 for jester_hard_18 is: 1.1413543671369553 to 1.4000559598207474
Loading the trained NF model from: models/jester_hard/Aplus/19
Loaded the NF for run jester_hard_19
The range of m1 for jester_hard_19 is: 1.6172172874212265 to 1.9136884063482285
The range of m2 for jester_hard_19 is: 1.3775890320539474 to 1.6212638467550278
Loading the trained NF model from: models/jester_hard/Aplus/20
Loaded the NF for run jester_hard_20
The range of m1 for jester_hard_20 is: 1.7659715563058853 to 2.3196782916784286
The range of m2 for jester_hard_20 is: 1.2250345200300217 to 1.5755338221788406
Loading the trained NF model from: models/jester_hard/Aplus/21
Tried looking for the NF architecture at path /gpfs/home6/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/NF/models/jester_hard/Aplus/21.eqx, but it doesn't exist!
Could not load the likelihood for id 21, because of the following error: [Errno 2] No such file or directory: '/gpfs/home6/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/NF/models/jester_hard/Aplus/21_kwargs.json'
Moving on
Loading the trained NF model from: models/jester_hard/Aplus/22
Loaded the NF for run jester_hard_22
The range of m1 for jester_hard_22 is: 1.6060354560613632 to 2.0495422929525375
The range of m2 for jester_hard_22 is: 1.2845046073198318 to 1.6221312433481216
Loading the trained NF model from: models/jester_hard/Aplus/23
Tried looking for the NF architecture at path /gpfs/home6/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/NF/models/jester_hard/Aplus/23.eqx, but it doesn't exist!
Could not load the likelihood for id 23, because of the following error: [Errno 2] No such file or directory: '/gpfs/home6/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/NF/models/jester_hard/Aplus/23_kwargs.json'
Moving on
Loading the trained NF model from: models/jester_hard/Aplus/24
Loaded the NF for run jester_hard_24
The range of m1 for jester_hard_24 is: 1.4223139733076096 to 1.7562010139226913
The range of m2 for jester_hard_24 is: 1.1745583266019821 to 1.443253979086876
Loading the trained NF model from: models/jester_hard/Aplus/25
Loaded the NF for run jester_hard_25
The range of m1 for jester_hard_25 is: 1.6875102370977402 to 1.8675268441438675
The range of m2 for jester_hard_25 is: 1.5420307964086533 to 1.7106600850820541
Loading the trained NF model from: models/jester_hard/Aplus/26
Loaded the NF for run jester_hard_26
The range of m1 for jester_hard_26 is: 2.2128383070230484 to 2.663474604487419
The range of m2 for jester_hard_26 is: 1.8612044304609299 to 2.236974760890007
Loading the trained NF model from: models/jester_hard/Aplus/27
Tried looking for the NF architecture at path /gpfs/home6/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/NF/models/jester_hard/Aplus/27.eqx, but it doesn't exist!
Could not load the likelihood for id 27, because of the following error: [Errno 2] No such file or directory: '/gpfs/home6/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/NF/models/jester_hard/Aplus/27_kwargs.json'
Moving on
Loading the trained NF model from: models/jester_hard/Aplus/28
Tried looking for the NF architecture at path /gpfs/home6/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/NF/models/jester_hard/Aplus/28.eqx, but it doesn't exist!
Could not load the likelihood for id 28, because of the following error: [Errno 2] No such file or directory: '/gpfs/home6/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/NF/models/jester_hard/Aplus/28_kwargs.json'
Moving on
Loading the trained NF model from: models/jester_hard/Aplus/29
Loaded the NF for run jester_hard_29
The range of m1 for jester_hard_29 is: 1.7424345761537552 to 1.9667413085699081
The range of m2 for jester_hard_29 is: 1.5730378776788712 to 1.7787473648786545
Loading the trained NF model from: models/jester_hard/Aplus/30
Loaded the NF for run jester_hard_30
The range of m1 for jester_hard_30 is: 1.4881259948015213 to 1.7888837307691574
The range of m2 for jester_hard_30 is: 1.2951310724020004 to 1.5385397523641586
There are 26 GW likelihoods used now
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x14645596f490>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x146454b22cb0>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x145251f94430>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x145251f82bc0>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x145251f7f3d0>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x145250aa37c0>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x1452504cd360>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x1452521dfd00>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x1451e7d58bb0>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x1451e78ebd90>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x145250263310>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x1451e7949210>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x14525017fac0>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x1451e76cb4c0>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x1451e7a0aec0>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x1451e6b2a8c0>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x1451e64e4be0>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x1451e64e5870>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x1451e1df1300>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x1451e73f18d0>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x1451e62d85b0>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x1451e1e75360>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x1451e1835c60>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x1451e1496770>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x1451e0e6a8f0>
<projection_BNS.EOS.inference_utils.GWlikelihood_with_masses object at 0x1451e1b23a00>
prior_keys
['E_sym', 'L_sym', 'K_sym', 'K_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'cs2_CSE_8']
all_prior_keys
['E_sym', 'L_sym', 'K_sym', 'K_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'cs2_CSE_8', 'key']
Prior parameter 0: E_sym
Prior parameter 1: L_sym
Prior parameter 2: K_sym
Prior parameter 3: K_sat
Prior parameter 4: nbreak
Prior parameter 5: n_CSE_0_u
Prior parameter 6: cs2_CSE_0
Prior parameter 7: n_CSE_1_u
Prior parameter 8: cs2_CSE_1
Prior parameter 9: n_CSE_2_u
Prior parameter 10: cs2_CSE_2
Prior parameter 11: n_CSE_3_u
Prior parameter 12: cs2_CSE_3
Prior parameter 13: n_CSE_4_u
Prior parameter 14: cs2_CSE_4
Prior parameter 15: n_CSE_5_u
Prior parameter 16: cs2_CSE_5
Prior parameter 17: n_CSE_6_u
Prior parameter 18: cs2_CSE_6
Prior parameter 19: n_CSE_7_u
Prior parameter 20: cs2_CSE_7
Prior parameter 21: cs2_CSE_8
Prior parameter 22: key
Fixed params loaded inside the MicroToMacroTransform:
    E_sat: -16.0
We are going to give these kwargs to Jim:
{'n_loop_training': 60, 'n_loop_production': 20, 'n_chains': 1000, 'n_local_steps': 2, 'n_global_steps': 50, 'n_epochs': 20, 'train_thinning': 1, 'output_thinning': 5}
We are going to sample the following parameters:
['E_sym', 'L_sym', 'K_sym', 'K_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'cs2_CSE_8', 'key']
No sample transforms provided. Using prior parameters as sampling parameters
Jim received the local sampler name: GaussianRandomWalk
Step size given was a matrix, converting to diagonal for GaussianRandomWalk
['n_dim', 'n_chains', 'n_local_steps', 'n_global_steps', 'n_loop', 'output_thinning', 'verbose']
log_prob
[-4.12547133e+05 -1.69880448e+07 -1.43487350e+08]
Sampling seed is set to: 11
Global Tuning:   0%|          | 0/60 [00:00<?, ?it/s]2025-04-03 16:36:14.915918: W external/xla/xla/service/hlo_rematerialization.cc:3005] Can't reduce memory use below 66.34GiB (71233899187 bytes) by rematerialization; only reduced to 250.83GiB (269328821976 bytes), down from 252.93GiB (271578832712 bytes) originally
2025-04-03 16:36:37.436780: W external/xla/xla/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 252.26GiB (rounded to 270866052608)requested by op 
2025-04-03 16:36:37.438450: W external/xla/xla/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0403 16:36:37.438489 2312711 pjrt_stream_executor_client.cc:3067] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 270866052368 bytes.
Global Tuning:   0%|          | 0/60 [01:23<?, ?it/s]
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/home6/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/EOS/inference.py", line 406, in <module>
    main(args)
  File "/gpfs/home6/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/EOS/inference.py", line 333, in main
    jim.sample(jax.random.PRNGKey(args.sampling_seed))
  File "/gpfs/home6/twouters2/projects/jax_tov_eos/jim/src/jimgw/jim.py", line 127, in sample
    self.sampler.sample(initial_position, None)  # type: ignore
  File "/gpfs/home6/twouters2/projects/jax_tov_eos/flowMC/src/flowMC/Sampler.py", line 204, in sample
    ) = strategy(
  File "/gpfs/home6/twouters2/projects/jax_tov_eos/flowMC/src/flowMC/strategy/global_tuning.py", line 92, in __call__
    ) = local_sampler.sample(
  File "/gpfs/home6/twouters2/projects/jax_tov_eos/flowMC/src/flowMC/proposal/Gaussian_random_walk.py", line 106, in sample
    logp = self.logpdf_vmap(initial_position, data)
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 270866052368 bytes.
DONE

JOB STATISTICS
==============
Job ID: 10966912
Cluster: snellius
User/Group: twouters2/twouters2
State: RUNNING
Nodes: 1
Cores per node: 16
CPU Utilized: 00:00:00
CPU Efficiency: 0.00% of 01:12:32 core-walltime
Job Wall-clock time: 00:04:32
Memory Utilized: 0.00 MB
Memory Efficiency: 0.00% of 20.00 GB (20.00 GB/node)
WARNING: Efficiency statistics can only be obtained after the job has ended as seff tool is based on the accounting database data.
