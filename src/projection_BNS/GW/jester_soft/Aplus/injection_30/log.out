Wed Apr  2 07:33:40 CEST 2025
NVIDIA H100
/gpfs/home6/twouters2/ninjax_dev/jim/src/jimgw/prior.py:94: UserWarning: As of jaxtyping version 0.2.24, jaxtyping now prefers the syntax
```
from jaxtyping import jaxtyped
# Use your favourite typechecker: usually one of the two lines below.
from typeguard import typechecked as typechecker
from beartype import beartype as typechecker

@jaxtyped(typechecker=typechecker)
def foo(...):
```
and the old double-decorator syntax
```
@jaxtyped
@typechecker
def foo(...):
```
should no longer be used. (It will continue to work as it did before, but the new approach will produce more readable error messages.)
In particular note that `typechecker` must be passed via keyword argument; the following is not valid:
```
@jaxtyped(typechecker)
def foo(...):
```

  class Uniform(Prior):
/gpfs/home6/twouters2/ninjax_dev/jim/src/jimgw/prior.py:149: UserWarning: As of jaxtyping version 0.2.24, jaxtyping now prefers the syntax
```
from jaxtyping import jaxtyped
# Use your favourite typechecker: usually one of the two lines below.
from typeguard import typechecked as typechecker
from beartype import beartype as typechecker

@jaxtyped(typechecker=typechecker)
def foo(...):
```
and the old double-decorator syntax
```
@jaxtyped
@typechecker
def foo(...):
```
should no longer be used. (It will continue to work as it did before, but the new approach will produce more readable error messages.)
In particular note that `typechecker` must be passed via keyword argument; the following is not valid:
```
@jaxtyped(typechecker)
def foo(...):
```

  class Unconstrained_Uniform(Prior):
/gpfs/home6/twouters2/ninjax_dev/jim/src/jimgw/prior.py:263: UserWarning: As of jaxtyping version 0.2.24, jaxtyping now prefers the syntax
```
from jaxtyping import jaxtyped
# Use your favourite typechecker: usually one of the two lines below.
from typeguard import typechecked as typechecker
from beartype import beartype as typechecker

@jaxtyped(typechecker=typechecker)
def foo(...):
```
and the old double-decorator syntax
```
@jaxtyped
@typechecker
def foo(...):
```
should no longer be used. (It will continue to work as it did before, but the new approach will produce more readable error messages.)
In particular note that `typechecker` must be passed via keyword argument; the following is not valid:
```
@jaxtyped(typechecker)
def foo(...):
```

  class AlignedSpin(Prior):
/gpfs/home6/twouters2/ninjax_dev/jim/src/jimgw/prior.py:377: UserWarning: As of jaxtyping version 0.2.24, jaxtyping now prefers the syntax
```
from jaxtyping import jaxtyped
# Use your favourite typechecker: usually one of the two lines below.
from typeguard import typechecked as typechecker
from beartype import beartype as typechecker

@jaxtyped(typechecker=typechecker)
def foo(...):
```
and the old double-decorator syntax
```
@jaxtyped
@typechecker
def foo(...):
```
should no longer be used. (It will continue to work as it did before, but the new approach will produce more readable error messages.)
In particular note that `typechecker` must be passed via keyword argument; the following is not valid:
```
@jaxtyped(typechecker)
def foo(...):
```

  class PowerLaw(Prior):
/gpfs/home6/twouters2/ninjax_dev/jim/src/jimgw/single_event/detector.py:496: UserWarning: As of jaxtyping version 0.2.24, jaxtyping now prefers the syntax
```
from jaxtyping import jaxtyped
# Use your favourite typechecker: usually one of the two lines below.
from typeguard import typechecked as typechecker
from beartype import beartype as typechecker

@jaxtyped(typechecker=typechecker)
def foo(...):
```
and the old double-decorator syntax
```
@jaxtyped
@typechecker
def foo(...):
```
should no longer be used. (It will continue to work as it did before, but the new approach will produce more readable error messages.)
In particular note that `typechecker` must be passed via keyword argument; the following is not valid:
```
@jaxtyped(typechecker)
def foo(...):
```

  def load_psd(
07:33 ninjax INFO    : Checking and setting outdir
07:33 ninjax INFO    : Found generation prior file ./Aplus/injection_30/generation_prior.prior
07:33 ninjax INFO    : The outdir is set to ./Aplus/injection_30
07:33 ninjax INFO    : Loading the given config
07:33 ninjax WARNING : Unrecognized keys given: {'n_max_examples'}. These will be ignored
07:33 ninjax INFO    : Arguments loaded into the config: {'likelihood': 'HeterodynedTransientLikelihoodFD', 'gw_injection': 'True', 'gw_load_existing_injection': 'False', 'gw_dump_injection_data': 'False', 'gw_SNR_threshold_low': '11.2', 'gw_SNR_threshold_high': '100', 'waveform_approximant': 'IMRPhenomD_NRTidalv2', 'waveform_approximant_1': 'None', 'waveform_approximant_2': 'None', 'gw_overlapping_tight_priors': 'False', 'ifos': 'H1,L1,V1', 'eos_file': '/home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/eos/jester_soft.npz', 'fmin': '20.0', 'fref': '20.0', 'fmax': '2048.0', 'duration': 'None', 'post_trigger_duration': '2.0', 'trigger_time': '1187008882.4', 'psd_file_H1': '/home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/psds/AplusDesign_PSD.txt', 'psd_file_L1': '/home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/psds/AplusDesign_PSD.txt', 'psd_file_V1': '/home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/psds/avirgo_O5high_NEW_PSD.txt', 'psd_file_ET1': '/home/twouters2/psds/ET_D_psd.txt', 'psd_file_ET2': '/home/twouters2/psds/ET_D_psd.txt', 'psd_file_ET3': '/home/twouters2/psds/ET_D_psd.txt', 'psd_file_CE': '/home/twouters2/psds/CE_psd.txt', 'data_file_H1': 'None', 'data_file_L1': 'None', 'data_file_V1': 'None', 'data_file_ET1': 'None', 'data_file_ET2': 'None', 'data_file_ET3': 'None', 'relative_binning_binsize': '1000', 'relative_binning_ref_params_equal_true_params': 'True', 'relative_binning_ref_params': 'None', 'transforms': 'q_to_eta,cos_iota_to_iota,sin_dec_to_dec', 'gw_kwargs': 'None', 'filters': 'None', 'tmin': '0.05', 'tmax': '15.0', 'em_injection': 'False', 'em_trigger_time': '0.0', 'em_data_path': 'None', 'KN_model_name': 'None', 'KN_class_name': 'None', 'KN_model_dir': 'None', 'GRB_model_name': 'None', 'GRB_class_name': 'None', 'GRB_model_dir': 'None', 'detection_limit': 'None', 'n_loop_training': '200', 'n_loop_production': '10', 'n_local_steps': '100', 'n_global_steps': '1_000', 'n_epochs': '25', 'n_chains': '1_000', 'learning_rate': '0.001', 'max_samples': '50000', 'momentum': '0.9', 'batch_size': '30000', 'use_global': 'True', 'keep_quantile': '0.0', 'train_thinning': '10', 'output_thinning': '50', 'n_sample_max': '10000', 'verbose': 'False', 'save_training_chains': 'False', 'eps_mass_matrix': '1e-5', 'use_scheduler': 'True', 'use_temperature': 'False', 'which_temperature_schedule': 'exponential', 'starting_temperature': '2.0', 'stop_tempering_iteration': '75', 'stopping_criterion_global_acc': '0.10', 'stopping_criterion_loss': '-inf', 'seed': 'None', 'sampling_seed': 'None', 'injection_generation_seed': 'None', 'num_layers': '10', 'hidden_size': '128,128', 'num_bins': '8', 'nf_model_kwargs': 'None', 'run_sampler': 'True', 'keys_to_plot': 'M_c, q, s1_z, s2_z, lambda_1, lambda_2, d_L, t_c, phase_c, iota, psi, ra, dec'}
07:33 ninjax INFO    : Complete config file written to /gpfs/home6/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/GW/jester_soft/Aplus/injection_30/complete_config.json
07:33 ninjax INFO    : No seed specified. Generating a random seed: 521649
07:33 ninjax INFO    : No sampling_seed specified. Generating a random sampling_seed: 207207
07:33 ninjax INFO    : No injection_generation_seed specified. Generating a random injection_generation_seed: 681794
07:33 ninjax INFO    : Loading the priors
07:33 ninjax INFO    : Setting up the prior
07:33 ninjax INFO    :    Mc_prior = Uniform(0.98, 2.6, naming=["M_c"])
07:33 ninjax INFO    :    q_prior = Uniform(0.125, 1.0, naming=["q"])
07:33 ninjax INFO    :    s1_z_prior = Uniform(-0.05, 0.05, naming=["s1_z"])
07:33 ninjax INFO    :    s2_z_prior = Uniform(-0.05, 0.05, naming=["s2_z"])
07:33 ninjax INFO    :    lambda1_prior = Uniform(0.0, 5000.0, naming=["lambda_1"])
07:33 ninjax INFO    :    lambda2_prior = Uniform(0.0, 5000.0, naming=["lambda_2"])
07:33 ninjax INFO    :    cos_iota_prior = Uniform(-1.0, 1.0, naming=["cos_iota"])
07:33 ninjax INFO    :    dL_prior = PowerLaw(1.0, 1000.0, 2.0, naming=["d_L"])
07:33 ninjax INFO    :    t_c_prior = Uniform(-0.1, 0.1, naming=["t_c"])
07:33 ninjax INFO    :    phase_c_prior = Uniform(0.0, 2 * jnp.pi, naming=["phase_c"])
07:33 ninjax INFO    :    psi_prior = Uniform(0.0, jnp.pi, naming=["psi"])
07:33 ninjax INFO    :    ra_prior = Uniform(0.0, 2 * jnp.pi, naming=["ra"])
07:33 ninjax INFO    :    sin_dec_prior = Uniform(-1.0, 1.0, naming=["sin_dec"])
07:33 ninjax INFO    : Setting up the generation prior
07:33 ninjax INFO    :    mass_1_source_prior = Uniform(1.0, 1.99, naming=["mass_1_source"])
07:33 ninjax INFO    :    mass_2_source_prior = Uniform(1.0, 1.99, naming=["mass_2_source"])
07:33 ninjax INFO    :    s1_z_prior = Uniform(-0.05, 0.05, naming=["s1_z"])
07:33 ninjax INFO    :    s2_z_prior = Uniform(-0.05, 0.05, naming=["s2_z"])
07:33 ninjax INFO    :    cos_iota_prior = Uniform(-1.0, 1.0, naming=["cos_iota"])
07:33 ninjax INFO    :    dL_prior = PowerLaw(10.0, 460.0, 2.0, naming=["d_L"])
07:33 ninjax INFO    :    t_c_prior = Uniform(-0.1, 0.1, naming=["t_c"])
07:33 ninjax INFO    :    phase_c_prior = Uniform(0.0, 2 * jnp.pi, naming=["phase_c"])
07:33 ninjax INFO    :    psi_prior = Uniform(0.0, jnp.pi, naming=["psi"])
07:33 ninjax INFO    :    ra_prior = Uniform(0.0, 2 * jnp.pi, naming=["ra"])
07:33 ninjax INFO    :    sin_dec_prior = Uniform(-1.0, 1.0, naming=["sin_dec"])
07:33 ninjax INFO    : Finished prior setup
07:33 ninjax INFO    : Setting the transforms
07:33 ninjax INFO    : Raw transforms list is q_to_eta,cos_iota_to_iota,sin_dec_to_dec
07:33 ninjax INFO    : transforms_str_list has 3 elements
07:33 ninjax INFO    : DEBUG: Checking that all_transforms is OK: the list is ['binary_Love', 'binary_love_fit', 'cos_iota1_to_iota1', 'cos_iota2_to_iota2', 'cos_iota_to_iota', 'log_lambda_to_lambda', 'm1_m2_to_Mc_q', 'q1_to_eta1', 'q2_to_eta2', 'q_to_eta', 'sin_dec1_to_dec1', 'sin_dec2_to_dec2', 'sin_dec_to_dec', 'spin_sphere_to_cartesian_s1', 'spin_sphere_to_cartesian_s2', 'swap_lambdas_eos', 't_c_dt_to_tcs']
07:33 ninjax INFO    : Setting the likelihood
07:33 ninjax INFO    : GW likelihood provided, setting up the GW pipe
07:33 ninjax INFO    : eos_file is /home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/eos/jester_soft.npz
07:33 ninjax INFO    : Using eos_file /home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/eos/jester_soft.npz for BNS injections
07:33 ninjax INFO    : Note: No specific waveform approximant 1 so defaulting to IMRPhenomD_NRTidalv2
07:33 ninjax INFO    : self.is_BNS_run is True
07:33 ninjax INFO    : Using IMRPhenomD_NRTidalv2 waveform. Therefore, we will use no taper as the reference waveform for the likelihood if relative binning is used
07:33 ninjax INFO    : GW run is an injection
07:33 ninjax INFO    : Setting up GW injection . . . 
07:33 ninjax INFO    : The SNR thresholds are: 11.2 - 100.0
07:33 ninjax INFO    : Generating new injection
07:33 ninjax INFO    : Sanity check: generated parameters:
07:33 ninjax INFO    : {'mass_1_source': 1.6538372022187713, 'mass_2_source': 1.264364317760234, 's1_z': -0.048144685069841445, 's2_z': -0.027269839802989693, 'cos_iota': 0.5178957509813356, 'd_L': 405.03807396091054, 't_c': -0.06817719828654956, 'phase_c': 4.44389392924023, 'psi': 0.1418080243445222, 'ra': 3.7259057832928435, 'sin_dec': -0.13353562480281322}
07:33 ninjax INFO    : Computing lambdas from EOS file /home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/eos/jester_soft.npz . . . 
07:33 ninjax INFO    : Injected lambda_1: 54.61205967281923
07:33 ninjax INFO    : Injected lambda_2: 375.1661856315124
07:33 ninjax INFO    : Duration is not specified in the config. Computed chirp time: for fmin = 20.0 and M_c = 1.3716016452479531 is 256.0
07:33 ninjax INFO    : After transforms, the injection parameters are:
07:33 ninjax INFO    : {'mass_1_source': 1.6538372022187713, 'mass_2_source': 1.264364317760234, 's1_z': -0.048144685069841445, 's2_z': -0.027269839802989693, 'cos_iota': 0.5178957509813356, 'd_L': 405.03807396091054, 't_c': -0.06817719828654956, 'phase_c': 4.44389392924023, 'psi': 0.1418080243445222, 'ra': 3.7259057832928435, 'sin_dec': -0.13353562480281322, 'q': 0.7645034928855002, 'M_c': 1.3716016452479531, 'eta': 0.24554688506947092, 'iota': Array(1.02640705, dtype=float64, weak_type=True), 'dec': Array(-0.13393571, dtype=float64, weak_type=True), 'lambda_1': 54.61205967281923, 'lambda_2': 375.1661856315124}
07:33 ninjax INFO    : The trial injection parameters are {'M_c': 1.3716016452479531, 'eta': 0.24554688506947092, 's1_z': -0.048144685069841445, 's2_z': -0.027269839802989693, 'lambda_1': 54.61205967281923, 'lambda_2': 375.1661856315124, 'd_L': 405.03807396091054, 'phase_c': 4.44389392924023, 'iota': 1.0264070462537902, 't_c': -0.06817719828654956, 'psi': 0.1418080243445222, 'ra': 3.7259057832928435, 'dec': -0.1339357061659243}
07:33 ninjax INFO    : Injecting signals . . .
07:33 ninjax INFO    : self.ifos
07:33 ninjax INFO    : [GroundBased2G(H1), GroundBased2G(L1), GroundBased2G(V1)]
07:33 ninjax INFO    : Signal injected in ifo H1. Frequencies, data, and PSD:
07:33 ninjax INFO    : [  20.           20.00390625   20.0078125  ... 2047.98828125
 2047.9921875  2047.99609375]
07:33 ninjax INFO    : [-3.36213829e-23-8.38714136e-23j  7.96815560e-23-7.50651654e-23j
  3.57584536e-23+6.05335677e-23j ...
 -6.93828348e-23-1.79364042e-23j  3.22972275e-23+2.85127662e-23j
  1.80622998e-23+1.61674274e-23j]
07:33 ninjax INFO    : [1.44906511e-46 1.44785671e-46 1.44667215e-46 ... 2.17778216e-47
 2.17778992e-47 2.17779767e-47]
07:33 ninjax INFO    : Signal injected in ifo L1. Frequencies, data, and PSD:
07:33 ninjax INFO    : [  20.           20.00390625   20.0078125  ... 2047.98828125
 2047.9921875  2047.99609375]
07:33 ninjax INFO    : [-3.46020252e-23-1.57530983e-22j  4.87178371e-23-9.78236738e-23j
  3.78938968e-23+1.43559999e-22j ...
  3.74822594e-24-3.97956077e-23j -3.60039071e-24+2.20601294e-23j
 -1.34140762e-23+5.43949037e-23j]
07:33 ninjax INFO    : [1.44906511e-46 1.44785671e-46 1.44667215e-46 ... 2.17778216e-47
 2.17778992e-47 2.17779767e-47]
07:33 ninjax INFO    : Signal injected in ifo V1. Frequencies, data, and PSD:
07:33 ninjax INFO    : [  20.           20.00390625   20.0078125  ... 2047.98828125
 2047.9921875  2047.99609375]
07:33 ninjax INFO    : [ 7.17471600e-23-1.72517870e-23j  8.29205627e-23-2.34030022e-23j
 -1.65834958e-23+3.65921293e-23j ...
 -4.45596414e-23+1.38779783e-22j -3.39977448e-23-3.80865948e-23j
  1.26125406e-23-1.11111130e-23j]
07:33 ninjax INFO    : [1.43183556e-46 1.43058540e-46 1.42935095e-46 ... 6.39793039e-47
 6.39795354e-47 6.39797668e-47]
07:33 ninjax INFO    : SNR for ifo H1 is 7.004199505610154
07:33 ninjax INFO    : SNR for ifo L1 is 7.72576459670974
07:33 ninjax INFO    : SNR for ifo V1 is 3.612435009604047
07:33 ninjax INFO    : The network SNR is 11.036119608665725
07:33 ninjax INFO    : The network SNR does not pass the threshold, trying again
07:33 ninjax INFO    : Generating new injection
07:33 ninjax INFO    : Sanity check: generated parameters:
07:33 ninjax INFO    : {'mass_1_source': 1.5136753965414451, 'mass_2_source': 1.8320659017751955, 's1_z': 0.015979211544047467, 's2_z': -0.025989272983330494, 'cos_iota': -0.4663366526097752, 'd_L': 406.8376657200512, 't_c': 0.09411374617331975, 'phase_c': 2.8034662145393203, 'psi': 0.9259723527489728, 'ra': 4.48254874216697, 'sin_dec': 0.05800020901182723}
07:33 ninjax INFO    : Computing lambdas from EOS file /home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/eos/jester_soft.npz . . . 
07:33 ninjax INFO    : Injected lambda_1: 23.30120051611007
07:33 ninjax INFO    : Injected lambda_2: 106.08421960389518
07:33 ninjax INFO    : Duration is not specified in the config. Computed chirp time: for fmin = 20.0 and M_c = 1.5815380858033223 is 128.0
07:33 ninjax INFO    : After transforms, the injection parameters are:
07:33 ninjax INFO    : {'mass_1_source': 1.8320659017751955, 'mass_2_source': 1.5136753965414451, 's1_z': 0.015979211544047467, 's2_z': -0.025989272983330494, 'cos_iota': -0.4663366526097752, 'd_L': 406.8376657200512, 't_c': 0.09411374617331975, 'phase_c': 2.8034662145393203, 'psi': 0.9259723527489728, 'ra': 4.48254874216697, 'sin_dec': 0.05800020901182723, 'q': 0.8262123076875983, 'M_c': 1.5815380858033223, 'eta': 0.24773600475356022, 'iota': Array(2.05594135, dtype=float64, weak_type=True), 'dec': Array(0.05803278, dtype=float64, weak_type=True), 'lambda_1': 23.30120051611007, 'lambda_2': 106.08421960389518}
07:33 ninjax INFO    : The trial injection parameters are {'M_c': 1.5815380858033223, 'eta': 0.24773600475356022, 's1_z': 0.015979211544047467, 's2_z': -0.025989272983330494, 'lambda_1': 23.30120051611007, 'lambda_2': 106.08421960389518, 'd_L': 406.8376657200512, 'phase_c': 2.8034662145393203, 'iota': 2.0559413496241747, 't_c': 0.09411374617331975, 'psi': 0.9259723527489728, 'ra': 4.48254874216697, 'dec': 0.05803277735649708}
07:33 ninjax INFO    : Injecting signals . . .
07:33 ninjax INFO    : self.ifos
07:33 ninjax INFO    : [GroundBased2G(H1), GroundBased2G(L1), GroundBased2G(V1)]
07:33 ninjax INFO    : Signal injected in ifo H1. Frequencies, data, and PSD:
07:33 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
07:33 ninjax INFO    : [-1.06994297e-22-1.15846440e-22j -7.09190289e-24-3.23623432e-23j
 -1.11362021e-22-7.19779955e-23j ...
 -2.20801823e-23-4.79058810e-24j -5.17098058e-24+4.54573041e-24j
  1.50927919e-23+1.51649387e-23j]
07:33 ninjax INFO    : [1.44906511e-46 1.44667215e-46 1.44435812e-46 ... 2.17775889e-47
 2.17777440e-47 2.17778992e-47]
07:33 ninjax INFO    : Signal injected in ifo L1. Frequencies, data, and PSD:
07:33 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
07:33 ninjax INFO    : [-3.02456039e-23-6.52978847e-24j -4.39696736e-23-9.33102098e-23j
 -1.06663305e-23-7.74325574e-23j ...
 -2.05348565e-23-1.58396067e-23j -4.48134469e-24+1.58495711e-23j
 -1.93129673e-23-2.33827926e-23j]
07:33 ninjax INFO    : [1.44906511e-46 1.44667215e-46 1.44435812e-46 ... 2.17775889e-47
 2.17777440e-47 2.17778992e-47]
07:33 ninjax INFO    : Signal injected in ifo V1. Frequencies, data, and PSD:
07:33 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
07:33 ninjax INFO    : [-2.69189007e-23-2.71895097e-23j  7.66267162e-23-2.88409136e-23j
  3.22264612e-23-7.79910083e-25j ...
  3.77216198e-23-8.36465301e-23j  1.50956343e-24+4.02569890e-23j
  9.79260144e-24-2.30935239e-23j]
07:33 ninjax INFO    : [1.43183556e-46 1.42935095e-46 1.42688205e-46 ... 6.39786094e-47
 6.39790724e-47 6.39795354e-47]
07:33 ninjax INFO    : SNR for ifo H1 is 5.467176411375539
07:33 ninjax INFO    : SNR for ifo L1 is 7.213727734257211
07:33 ninjax INFO    : SNR for ifo V1 is 3.1413291580788494
07:33 ninjax INFO    : The network SNR is 9.581014279108928
07:33 ninjax INFO    : The network SNR does not pass the threshold, trying again
07:33 ninjax INFO    : Generating new injection
07:33 ninjax INFO    : Sanity check: generated parameters:
07:33 ninjax INFO    : {'mass_1_source': 1.0103941681605113, 'mass_2_source': 1.9660195192661258, 's1_z': 0.043734452375118374, 's2_z': -0.0460195441595864, 'cos_iota': 0.34176233639191356, 'd_L': 410.1079313009064, 't_c': 0.04559457813140555, 'phase_c': 1.4645195643400422, 'psi': 2.5714147862389605, 'ra': 3.6218895445115704, 'sin_dec': 0.2745409235595506}
07:33 ninjax INFO    : Computing lambdas from EOS file /home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/eos/jester_soft.npz . . . 
07:33 ninjax INFO    : Injected lambda_1: 9.944598435593662
07:33 ninjax INFO    : Injected lambda_2: 1696.230837652087
07:33 ninjax INFO    : Duration is not specified in the config. Computed chirp time: for fmin = 20.0 and M_c = 1.3261607030859992 is 256.0
07:33 ninjax INFO    : After transforms, the injection parameters are:
07:33 ninjax INFO    : {'mass_1_source': 1.9660195192661258, 'mass_2_source': 1.0103941681605113, 's1_z': 0.043734452375118374, 's2_z': -0.0460195441595864, 'cos_iota': 0.34176233639191356, 'd_L': 410.1079313009064, 't_c': 0.04559457813140555, 'phase_c': 1.4645195643400422, 'psi': 2.5714147862389605, 'ra': 3.6218895445115704, 'sin_dec': 0.2745409235595506, 'q': 0.5139288589248954, 'M_c': 1.3261607030859992, 'eta': 0.22422914975494587, 'iota': Array(1.22200482, dtype=float64, weak_type=True), 'dec': Array(0.27811225, dtype=float64, weak_type=True), 'lambda_1': 9.944598435593662, 'lambda_2': 1696.230837652087}
07:33 ninjax INFO    : The trial injection parameters are {'M_c': 1.3261607030859992, 'eta': 0.22422914975494587, 's1_z': 0.043734452375118374, 's2_z': -0.0460195441595864, 'lambda_1': 9.944598435593662, 'lambda_2': 1696.230837652087, 'd_L': 410.1079313009064, 'phase_c': 1.4645195643400422, 'iota': 1.2220048151114495, 't_c': 0.04559457813140555, 'psi': 2.5714147862389605, 'ra': 3.6218895445115704, 'dec': 0.2781122486812601}
07:33 ninjax INFO    : Injecting signals . . .
07:33 ninjax INFO    : self.ifos
07:33 ninjax INFO    : [GroundBased2G(H1), GroundBased2G(L1), GroundBased2G(V1)]
07:33 ninjax INFO    : Signal injected in ifo H1. Frequencies, data, and PSD:
07:33 ninjax INFO    : [  20.           20.00390625   20.0078125  ... 2047.98828125
 2047.9921875  2047.99609375]
07:33 ninjax INFO    : [-3.63892957e-23-8.03360010e-23j  8.29662427e-23-7.78582356e-23j
  3.21733203e-23+6.25296382e-23j ...
 -6.93882435e-23-1.79373561e-23j  3.22918739e-23+2.85115432e-23j
  1.80570147e-23+1.61659363e-23j]
07:33 ninjax INFO    : [1.44906511e-46 1.44785671e-46 1.44667215e-46 ... 2.17778216e-47
 2.17778992e-47 2.17779767e-47]
07:33 ninjax INFO    : Signal injected in ifo L1. Frequencies, data, and PSD:
07:33 ninjax INFO    : [  20.           20.00390625   20.0078125  ... 2047.98828125
 2047.9921875  2047.99609375]
07:33 ninjax INFO    : [-3.08214581e-23-1.60412302e-22j  4.46144598e-23-9.58133663e-23j
  4.20973187e-23+1.42416889e-22j ...
  3.74251165e-24-3.97976178e-23j -3.60599629e-24+2.20578341e-23j
 -1.34195589e-23+5.43923290e-23j]
07:33 ninjax INFO    : [1.44906511e-46 1.44785671e-46 1.44667215e-46 ... 2.17778216e-47
 2.17778992e-47 2.17779767e-47]
07:33 ninjax INFO    : Signal injected in ifo V1. Frequencies, data, and PSD:
07:33 ninjax INFO    : [  20.           20.00390625   20.0078125  ... 2047.98828125
 2047.9921875  2047.99609375]
07:33 ninjax INFO    : [ 7.48790939e-23-2.03540993e-23j  7.92895723e-23-2.13000291e-23j
 -1.27762970e-23+3.55417762e-23j ...
 -4.45561792e-23+1.38778816e-22j -3.39942378e-23-3.80873840e-23j
  1.26160831e-23-1.11117224e-23j]
07:33 ninjax INFO    : [1.43183556e-46 1.43058540e-46 1.42935095e-46 ... 6.39793039e-47
 6.39795354e-47 6.39797668e-47]
07:33 ninjax INFO    : SNR for ifo H1 is 3.5142758907177543
07:33 ninjax INFO    : SNR for ifo L1 is 3.419475782243701
07:33 ninjax INFO    : SNR for ifo V1 is 4.717483251112172
07:33 ninjax INFO    : The network SNR is 6.804233820641021
07:33 ninjax INFO    : The network SNR does not pass the threshold, trying again
07:33 ninjax INFO    : Generating new injection
07:33 ninjax INFO    : Sanity check: generated parameters:
07:33 ninjax INFO    : {'mass_1_source': 1.3406787388441204, 'mass_2_source': 1.1823165750539721, 's1_z': 0.02547008484497093, 's2_z': -0.0017703114153637678, 'cos_iota': -0.5037304948453061, 'd_L': 304.07240122208765, 't_c': -0.09164334080106484, 'phase_c': 0.8783370868945939, 'psi': 2.2638607425301607, 'ra': 5.4974451500619805, 'sin_dec': 0.01865078209852644}
07:33 ninjax INFO    : Computing lambdas from EOS file /home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/eos/jester_soft.npz . . . 
07:33 ninjax INFO    : Injected lambda_1: 250.04506137960425
07:33 ninjax INFO    : Injected lambda_2: 592.1533280626174
07:33 ninjax INFO    : Duration is not specified in the config. Computed chirp time: for fmin = 20.0 and M_c = 1.1708749049361629 is 256.0
07:33 ninjax INFO    : After transforms, the injection parameters are:
07:33 ninjax INFO    : {'mass_1_source': 1.3406787388441204, 'mass_2_source': 1.1823165750539721, 's1_z': 0.02547008484497093, 's2_z': -0.0017703114153637678, 'cos_iota': -0.5037304948453061, 'd_L': 304.07240122208765, 't_c': -0.09164334080106484, 'phase_c': 0.8783370868945939, 'psi': 2.2638607425301607, 'ra': 5.4974451500619805, 'sin_dec': 0.01865078209852644, 'q': 0.8818791115262395, 'M_c': 1.1708749049361629, 'eta': 0.24901505954650058, 'iota': Array(2.09870809, dtype=float64, weak_type=True), 'dec': Array(0.01865186, dtype=float64, weak_type=True), 'lambda_1': 250.04506137960425, 'lambda_2': 592.1533280626174}
07:33 ninjax INFO    : The trial injection parameters are {'M_c': 1.1708749049361629, 'eta': 0.24901505954650058, 's1_z': 0.02547008484497093, 's2_z': -0.0017703114153637678, 'lambda_1': 250.04506137960425, 'lambda_2': 592.1533280626174, 'd_L': 304.07240122208765, 'phase_c': 0.8783370868945939, 'iota': 2.0987080900579445, 't_c': -0.09164334080106484, 'psi': 2.2638607425301607, 'ra': 5.4974451500619805, 'dec': 0.018651863552110712}
07:33 ninjax INFO    : Injecting signals . . .
07:33 ninjax INFO    : self.ifos
07:33 ninjax INFO    : [GroundBased2G(H1), GroundBased2G(L1), GroundBased2G(V1)]
07:33 ninjax INFO    : Signal injected in ifo H1. Frequencies, data, and PSD:
07:33 ninjax INFO    : [  20.           20.00390625   20.0078125  ... 2047.98828125
 2047.9921875  2047.99609375]
07:33 ninjax INFO    : [-3.58110650e-23-8.19138657e-23j  8.08166739e-23-7.65365256e-23j
  3.51227811e-23+6.29484857e-23j ...
 -6.93895192e-23-1.79350036e-23j  3.22904788e-23+2.85138268e-23j
  1.80555040e-23+1.61681451e-23j]
07:33 ninjax INFO    : [1.44906511e-46 1.44785671e-46 1.44667215e-46 ... 2.17778216e-47
 2.17778992e-47 2.17779767e-47]
07:33 ninjax INFO    : Signal injected in ifo L1. Frequencies, data, and PSD:
07:33 ninjax INFO    : [  20.           20.00390625   20.0078125  ... 2047.98828125
 2047.9921875  2047.99609375]
07:33 ninjax INFO    : [-3.18815093e-23-1.58735557e-22j  4.73589012e-23-9.65266245e-23j
  3.92263486e-23+1.40897314e-22j ...
  3.73931766e-24-3.97972765e-23j -3.60920351e-24+2.20580113e-23j
 -1.34227709e-23+5.43923417e-23j]
07:33 ninjax INFO    : [1.44906511e-46 1.44785671e-46 1.44667215e-46 ... 2.17778216e-47
 2.17778992e-47 2.17779767e-47]
07:33 ninjax INFO    : Signal injected in ifo V1. Frequencies, data, and PSD:
07:33 ninjax INFO    : [  20.           20.00390625   20.0078125  ... 2047.98828125
 2047.9921875  2047.99609375]
07:33 ninjax INFO    : [ 6.98967386e-23-2.08354265e-23j  8.17106345e-23-1.86179569e-23j
 -1.27294544e-23+3.38775646e-23j ...
 -4.45614340e-23+1.38777387e-22j -3.39994126e-23-3.80890797e-23j
  1.26110018e-23-1.11136801e-23j]
07:33 ninjax INFO    : [1.43183556e-46 1.43058540e-46 1.42935095e-46 ... 6.39793039e-47
 6.39795354e-47 6.39797668e-47]
07:33 ninjax INFO    : SNR for ifo H1 is 3.0634692970482007
07:33 ninjax INFO    : SNR for ifo L1 is 3.677074015283229
07:33 ninjax INFO    : SNR for ifo V1 is 4.908077766525108
07:33 ninjax INFO    : The network SNR is 6.855285902869858
07:33 ninjax INFO    : The network SNR does not pass the threshold, trying again
07:33 ninjax INFO    : Generating new injection
07:33 ninjax INFO    : Sanity check: generated parameters:
07:33 ninjax INFO    : {'mass_1_source': 1.874485926573377, 'mass_2_source': 1.9004474614092948, 's1_z': -0.02619723183791243, 's2_z': 0.007316814448261114, 'cos_iota': -0.6268467979651628, 'd_L': 179.89396618251283, 't_c': 0.02947453386037563, 'phase_c': 6.218394076944833, 'psi': 1.0286891174782817, 'ra': 3.3393355213797236, 'sin_dec': -0.8437110478640069}
07:33 ninjax INFO    : Computing lambdas from EOS file /home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/eos/jester_soft.npz . . . 
07:33 ninjax INFO    : Injected lambda_1: 15.79155334437155
07:33 ninjax INFO    : Injected lambda_2: 18.473689104219368
07:33 ninjax INFO    : Duration is not specified in the config. Computed chirp time: for fmin = 20.0 and M_c = 1.709877119862579 is 128.0
07:33 ninjax INFO    : After transforms, the injection parameters are:
07:33 ninjax INFO    : {'mass_1_source': 1.9004474614092948, 'mass_2_source': 1.874485926573377, 's1_z': -0.02619723183791243, 's2_z': 0.007316814448261114, 'cos_iota': -0.6268467979651628, 'd_L': 179.89396618251283, 't_c': 0.02947453386037563, 'phase_c': 6.218394076944833, 'psi': 1.0286891174782817, 'ra': 3.3393355213797236, 'sin_dec': -0.8437110478640069, 'q': 0.986339251485192, 'M_c': 1.709877119862579, 'eta': 0.24998817551725036, 'iota': Array(2.2482959, dtype=float64, weak_type=True), 'dec': Array(-1.00415943, dtype=float64, weak_type=True), 'lambda_1': 15.79155334437155, 'lambda_2': 18.473689104219368}
07:33 ninjax INFO    : The trial injection parameters are {'M_c': 1.709877119862579, 'eta': 0.24998817551725036, 's1_z': -0.02619723183791243, 's2_z': 0.007316814448261114, 'lambda_1': 15.79155334437155, 'lambda_2': 18.473689104219368, 'd_L': 179.89396618251283, 'phase_c': 6.218394076944833, 'iota': 2.2482959015784294, 't_c': 0.02947453386037563, 'psi': 1.0286891174782817, 'ra': 3.3393355213797236, 'dec': -1.0041594281197206}
07:33 ninjax INFO    : Injecting signals . . .
07:33 ninjax INFO    : self.ifos
07:33 ninjax INFO    : [GroundBased2G(H1), GroundBased2G(L1), GroundBased2G(V1)]
07:33 ninjax INFO    : Signal injected in ifo H1. Frequencies, data, and PSD:
07:33 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
07:33 ninjax INFO    : [-1.21800157e-22-1.15990615e-22j -6.05431465e-24-1.90505887e-23j
 -9.98431658e-23-7.47924024e-23j ...
 -2.20566922e-23-4.75094499e-24j -5.15140150e-24+4.58741982e-24j
  1.51082839e-23+1.52082900e-23j]
07:33 ninjax INFO    : [1.44906511e-46 1.44667215e-46 1.44435812e-46 ... 2.17775889e-47
 2.17777440e-47 2.17778992e-47]
07:33 ninjax INFO    : Signal injected in ifo L1. Frequencies, data, and PSD:
07:33 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
07:33 ninjax INFO    : [-1.84126868e-23-1.48314689e-24j -3.84092715e-23-1.05733168e-22j
 -2.27973265e-23-8.31547309e-23j ...
 -2.05566712e-23-1.58159293e-23j -4.50531087e-24+1.58710172e-23j
 -1.93388583e-23-2.33637721e-23j]
07:33 ninjax INFO    : [1.44906511e-46 1.44667215e-46 1.44435812e-46 ... 2.17775889e-47
 2.17777440e-47 2.17778992e-47]
07:33 ninjax INFO    : Signal injected in ifo V1. Frequencies, data, and PSD:
07:33 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
07:33 ninjax INFO    : [-2.51389717e-23-2.29381455e-23j  8.17282854e-23-3.09349361e-23j
  3.01884971e-23-6.44769143e-24j ...
  3.77412422e-23-8.36539849e-23j  1.52981224e-24+4.02514429e-23j
  9.81329144e-24-2.30971099e-23j]
07:33 ninjax INFO    : [1.43183556e-46 1.42935095e-46 1.42688205e-46 ... 6.39786094e-47
 6.39790724e-47 6.39795354e-47]
07:33 ninjax INFO    : SNR for ifo H1 is 28.96416749081256
07:33 ninjax INFO    : SNR for ifo L1 is 22.239331806159523
07:33 ninjax INFO    : SNR for ifo V1 is 7.243491293721361
07:33 ninjax INFO    : The network SNR is 37.228739486350044
07:33 ninjax INFO    : Network SNR passes threshold
07:33 ninjax INFO    : Sanity checking the GW injection for ArrayImpl
07:33 ninjax INFO    :    mass_1_source: 1.9004474614092948
07:33 ninjax INFO    :    mass_2_source: 1.874485926573377
07:33 ninjax INFO    :    s1_z: -0.02619723183791243
07:33 ninjax INFO    :    s2_z: 0.007316814448261114
07:33 ninjax INFO    :    cos_iota: -0.6268467979651628
07:33 ninjax INFO    :    d_L: 179.89396618251283
07:33 ninjax INFO    :    t_c: 0.02947453386037563
07:33 ninjax INFO    :    phase_c: 6.218394076944833
07:33 ninjax INFO    :    psi: 1.0286891174782817
07:33 ninjax INFO    :    ra: 3.3393355213797236
07:33 ninjax INFO    :    sin_dec: -0.8437110478640069
07:33 ninjax INFO    :    q: 0.986339251485192
07:33 ninjax INFO    :    M_c: 1.709877119862579
07:33 ninjax INFO    :    eta: 0.24998817551725036
07:33 ninjax INFO    :    iota: 2.2482959015784294
07:33 ninjax INFO    :    dec: -1.0041594281197206
07:33 ninjax INFO    :    lambda_1: 15.79155334437155
07:33 ninjax INFO    :    lambda_2: 18.473689104219368
07:33 ninjax INFO    :    H1_SNR: 28.96416749081256
07:33 ninjax INFO    :    L1_SNR: 22.239331806159523
07:33 ninjax INFO    :    V1_SNR: 7.243491293721361
07:33 ninjax INFO    :    network_SNR: 37.228739486350044
07:33 ninjax INFO    :    epoch: 126.0
07:33 ninjax INFO    :    gmst: 2.7288901910520846
07:33 ninjax INFO    :    duration: 128.0
07:33 ninjax INFO    : Using GW HeterodynedTransientLikelihoodFD. Initializing likelihood
07:33 ninjax INFO    : Using the injection parameters as reference parameters for the relative binning
07:33 ninjax INFO    : Using the following kwargs for the GW likelihood: {}
07:36 ninjax INFO    : Initialization of HeterodynedTransientLikelihoodFD took 140.7269401550293 seconds = 2.3454490025838215 minutes
07:36 ninjax INFO    : The priors are not modified after their initialization
07:36 ninjax INFO    : Required keys for the likelihood: ['M_c', 'eta', 's1_z', 's2_z', 'lambda_1', 'lambda_2', 'd_L', 'phase_c', 'iota', 't_c', 'psi', 'ra', 'dec']
07:36 ninjax INFO    : Checking the setup between prior, transforms, and likelihood
07:36 ninjax INFO    : sample: {'M_c': Array([2.1383775 , 1.39108564, 1.55329901], dtype=float64), 'q': Array([0.57643617, 0.57061755, 0.29378253], dtype=float64), 's1_z': Array([-0.00985305, -0.04728742, -0.02805437], dtype=float64), 's2_z': Array([-0.00139839,  0.01143945,  0.04239521], dtype=float64), 'lambda_1': Array([4272.51227733, 2964.46703863,  441.77075641], dtype=float64), 'lambda_2': Array([1735.45595978, 3994.97404308, 3877.45280171], dtype=float64), 'cos_iota': Array([-0.97394705, -0.57022564,  0.23919539], dtype=float64), 'd_L': Array([959.55929975, 883.82144869, 636.20075604], dtype=float64), 't_c': Array([ 0.00368207,  0.06687237, -0.04293849], dtype=float64), 'phase_c': Array([6.03844496, 0.04084491, 4.78076685], dtype=float64), 'psi': Array([0.7706471 , 1.93766909, 2.55685375], dtype=float64), 'ra': Array([5.37912588, 0.19857706, 2.77195203], dtype=float64), 'sin_dec': Array([-0.48642255, -0.69682703,  0.79572022], dtype=float64)}
07:36 ninjax INFO    : log_prob: [-34.57834591  -6.0133992  -11.59697404]
07:36 ninjax INFO    : Checking log_prob at injection parameters: {'mass_1_source': 1.9004474614092948, 'mass_2_source': 1.874485926573377, 's1_z': -0.02619723183791243, 's2_z': 0.007316814448261114, 'cos_iota': -0.6268467979651628, 'd_L': 179.89396618251283, 't_c': 0.02947453386037563, 'phase_c': 6.218394076944833, 'psi': 1.0286891174782817, 'ra': 3.3393355213797236, 'sin_dec': -0.8437110478640069, 'q': 0.986339251485192, 'M_c': 1.709877119862579, 'eta': 0.24998817551725036, 'iota': Array(2.2482959, dtype=float64, weak_type=True), 'dec': Array(-1.00415943, dtype=float64, weak_type=True), 'lambda_1': 15.79155334437155, 'lambda_2': 18.473689104219368, 'H1_SNR': 28.96416749081256, 'L1_SNR': 22.239331806159523, 'V1_SNR': 7.243491293721361, 'network_SNR': 37.228739486350044, 'epoch': 126.0, 'gmst': 2.7288901910520846, 'duration': 128.0}
07:36 ninjax INFO    : log_prob at the injection parameters is: 629.3614139068972
07:36 ninjax INFO    : Will plot these keys: ['M_c', 'q', 's1_z', 's2_z', 'lambda_1', 'lambda_2', 'd_L', 't_c', 'phase_c', 'iota', 'psi', 'ra', 'dec']
07:36 ninjax INFO    : Will plot the labels: ['$M_c/M_\\odot$', '$q$', '$\\chi_1$', '$\\chi_2$', '$\\Lambda_1$', '$\\Lambda_2$', '$d_{\\rm{L}}/{\\rm Mpc}$', '$t_c$', '$\\phi_c$', '$\\iota$', '$\\psi$', '$\\alpha$', '$\\delta$']
07:36 ninjax INFO    : Ninjax setup complete.
07:36 ninjax INFO    : Saving output to ./Aplus/injection_30/
07:36 ninjax INFO    : Using polynomial learning rate scheduler
07:36 ninjax INFO    : The hyperparameters passed to flowMC and jim are
07:36 ninjax INFO    :    n_loop_training: 200
07:36 ninjax INFO    :    n_loop_production: 10
07:36 ninjax INFO    :    n_local_steps: 100
07:36 ninjax INFO    :    n_global_steps: 1000
07:36 ninjax INFO    :    n_epochs: 25
07:36 ninjax INFO    :    n_chains: 1000
07:36 ninjax INFO    :    learning_rate: <function polynomial_schedule.<locals>.schedule at 0x1453b3443f40>
07:36 ninjax INFO    :    max_samples: 50000
07:36 ninjax INFO    :    momentum: 0.9
07:36 ninjax INFO    :    batch_size: 30000
07:36 ninjax INFO    :    use_global: True
07:36 ninjax INFO    :    keep_quantile: 0.0
07:36 ninjax INFO    :    train_thinning: 10
07:36 ninjax INFO    :    output_thinning: 50
07:36 ninjax INFO    :    n_sample_max: 10000
07:36 ninjax INFO    :    num_layers: 10
07:36 ninjax INFO    :    hidden_size: [128, 128]
07:36 ninjax INFO    :    num_bins: 8
07:36 ninjax INFO    :    save_training_chains: False
07:36 ninjax INFO    :    eps_mass_matrix: 1e-05
07:36 ninjax INFO    :    use_scheduler: True
07:36 ninjax INFO    :    use_temperature: False
07:36 ninjax INFO    :    which_temperature_schedule: exponential
07:36 ninjax INFO    :    starting_temperature: 2.0
07:36 ninjax INFO    :    stop_tempering_iteration: 75
07:36 ninjax INFO    :    stopping_criterion_global_acc: 0.1
07:36 ninjax INFO    :    stopping_criterion_loss: -inf
07:36 ninjax INFO    :    nf_model_kwargs: {}
07:36 ninjax INFO    :    local sampler arg not shown (pretty print)
07:36 ninjax INFO    : Fetching the injected values for plotting
Checking the noise that was generated in inject_signal ifo:
[-3.48546492e-23  8.13396845e-23  3.37156114e-23 -1.17093403e-22
 -4.93377776e-23 -4.80079029e-23 -2.08181189e-23 -1.59244856e-22
 -8.36674574e-23  4.64550982e-23]
[-8.08762734e-23 -7.78468225e-23  6.30453402e-23  6.45445531e-23
  9.90390997e-25 -1.02387602e-23  3.23148340e-23 -6.48468053e-23
  3.86843654e-23  1.69135270e-23]
Checking the noise that was generated in inject_signal ifo:
[-3.24031932e-23  4.61310014e-23  4.08093545e-23  6.35588702e-23
 -3.03792507e-23  3.50145454e-23  6.36344120e-23  8.16357973e-23
  7.22492183e-23  4.94019891e-23]
[-1.60347010e-22 -9.53604836e-23  1.41497649e-22  8.65792282e-24
  6.63107648e-23 -1.81732296e-22 -4.89314123e-23 -2.73262919e-23
  4.30676634e-23 -9.61987443e-24]
Checking the noise that was generated in inject_signal ifo:
[ 7.23190819e-23  8.20548848e-23 -1.54460145e-23 -1.35347367e-22
  1.12050841e-22  7.10556844e-23 -4.11614882e-23 -1.15324939e-22
 -7.37547744e-23 -4.91550158e-23]
[-1.92934137e-23 -2.14680920e-23  3.48040144e-23  8.39369210e-23
  1.02408617e-22 -4.34424599e-23 -4.55312409e-23 -4.06062972e-24
  3.27480835e-23 -9.53536690e-23]
Checking the noise that was generated in inject_signal ifo:
[-1.08496240e-22 -9.59838920e-24 -1.12223894e-22 -5.05728804e-23
 -3.75874337e-23  3.27703861e-23 -6.34443288e-23 -7.75529633e-23
  3.92887199e-23 -8.19913544e-23]
[-1.17885807e-22 -3.20066706e-23 -6.95988602e-23 -3.49951233e-23
 -5.15530178e-23  3.39238068e-23  1.16475090e-22  3.78789561e-23
 -1.94521830e-23  2.65371169e-23]
Checking the noise that was generated in inject_signal ifo:
[-2.69789765e-23 -4.30437301e-23 -1.30654979e-23 -5.12132364e-23
  1.26138038e-22 -7.40860238e-23  8.36280671e-23 -2.91127890e-23
  4.07135777e-24  2.02502241e-23]
[-7.23495627e-24 -9.65196516e-23 -7.97545541e-23  1.82439782e-24
  5.49788791e-24  5.82120151e-23  1.60326824e-23  4.56721982e-23
  4.35531137e-24  4.24144562e-23]
Checking the noise that was generated in inject_signal ifo:
[-2.50725074e-23  7.74927307e-23  3.11950662e-23  2.63058341e-23
  1.89843377e-23 -3.16701898e-23 -1.19649878e-23 -4.98384634e-23
  2.06971931e-23 -6.47451389e-23]
[-2.72005010e-23 -3.04706944e-23 -2.30937810e-24 -2.89678341e-23
  2.19523639e-24  1.99046639e-23 -4.47823871e-23  1.07730645e-22
  3.58348924e-23  3.51971289e-23]
Checking the noise that was generated in inject_signal ifo:
[-3.48546492e-23  8.13396845e-23  3.37156114e-23 -1.17093403e-22
 -4.93377776e-23 -4.80079029e-23 -2.08181189e-23 -1.59244856e-22
 -8.36674574e-23  4.64550982e-23]
[-8.08762734e-23 -7.78468225e-23  6.30453402e-23  6.45445531e-23
  9.90390997e-25 -1.02387602e-23  3.23148340e-23 -6.48468053e-23
  3.86843654e-23  1.69135270e-23]
Checking the noise that was generated in inject_signal ifo:
[-3.24031932e-23  4.61310014e-23  4.08093545e-23  6.35588702e-23
 -3.03792507e-23  3.50145454e-23  6.36344120e-23  8.16357973e-23
  7.22492183e-23  4.94019891e-23]
[-1.60347010e-22 -9.53604836e-23  1.41497649e-22  8.65792282e-24
  6.63107648e-23 -1.81732296e-22 -4.89314123e-23 -2.73262919e-23
  4.30676634e-23 -9.61987443e-24]
Checking the noise that was generated in inject_signal ifo:
[ 7.23190819e-23  8.20548848e-23 -1.54460145e-23 -1.35347367e-22
  1.12050841e-22  7.10556844e-23 -4.11614882e-23 -1.15324939e-22
 -7.37547744e-23 -4.91550158e-23]
[-1.92934137e-23 -2.14680920e-23  3.48040144e-23  8.39369210e-23
  1.02408617e-22 -4.34424599e-23 -4.55312409e-23 -4.06062972e-24
  3.27480835e-23 -9.53536690e-23]
Checking the noise that was generated in inject_signal ifo:
[-3.48546492e-23  8.13396845e-23  3.37156114e-23 -1.17093403e-22
 -4.93377776e-23 -4.80079029e-23 -2.08181189e-23 -1.59244856e-22
 -8.36674574e-23  4.64550982e-23]
[-8.08762734e-23 -7.78468225e-23  6.30453402e-23  6.45445531e-23
  9.90390997e-25 -1.02387602e-23  3.23148340e-23 -6.48468053e-23
  3.86843654e-23  1.69135270e-23]
Checking the noise that was generated in inject_signal ifo:
[-3.24031932e-23  4.61310014e-23  4.08093545e-23  6.35588702e-23
 -3.03792507e-23  3.50145454e-23  6.36344120e-23  8.16357973e-23
  7.22492183e-23  4.94019891e-23]
[-1.60347010e-22 -9.53604836e-23  1.41497649e-22  8.65792282e-24
  6.63107648e-23 -1.81732296e-22 -4.89314123e-23 -2.73262919e-23
  4.30676634e-23 -9.61987443e-24]
Checking the noise that was generated in inject_signal ifo:
[ 7.23190819e-23  8.20548848e-23 -1.54460145e-23 -1.35347367e-22
  1.12050841e-22  7.10556844e-23 -4.11614882e-23 -1.15324939e-22
 -7.37547744e-23 -4.91550158e-23]
[-1.92934137e-23 -2.14680920e-23  3.48040144e-23  8.39369210e-23
  1.02408617e-22 -4.34424599e-23 -4.55312409e-23 -4.06062972e-24
  3.27480835e-23 -9.53536690e-23]
Checking the noise that was generated in inject_signal ifo:
[-1.08496240e-22 -9.59838920e-24 -1.12223894e-22 -5.05728804e-23
 -3.75874337e-23  3.27703861e-23 -6.34443288e-23 -7.75529633e-23
  3.92887199e-23 -8.19913544e-23]
[-1.17885807e-22 -3.20066706e-23 -6.95988602e-23 -3.49951233e-23
 -5.15530178e-23  3.39238068e-23  1.16475090e-22  3.78789561e-23
 -1.94521830e-23  2.65371169e-23]
Checking the noise that was generated in inject_signal ifo:
[-2.69789765e-23 -4.30437301e-23 -1.30654979e-23 -5.12132364e-23
  1.26138038e-22 -7.40860238e-23  8.36280671e-23 -2.91127890e-23
  4.07135777e-24  2.02502241e-23]
[-7.23495627e-24 -9.65196516e-23 -7.97545541e-23  1.82439782e-24
  5.49788791e-24  5.82120151e-23  1.60326824e-23  4.56721982e-23
  4.35531137e-24  4.24144562e-23]
Checking the noise that was generated in inject_signal ifo:
[-2.50725074e-23  7.74927307e-23  3.11950662e-23  2.63058341e-23
  1.89843377e-23 -3.16701898e-23 -1.19649878e-23 -4.98384634e-23
  2.06971931e-23 -6.47451389e-23]
[-2.72005010e-23 -3.04706944e-23 -2.30937810e-24 -2.89678341e-23
  2.19523639e-24  1.99046639e-23 -4.47823871e-23  1.07730645e-22
  3.58348924e-23  3.51971289e-23]
NOTE: we are given a reference waveform!
Initializing heterodyned likelihood..
Comparing against relative binning in bilby
Using 5941 bins for relative binning for epsilon 0.01
Time for binning scheme: 0.10607481002807617 seconds
Using provided reference parameters:
ref_params for relative binning:
{'mass_1_source': 1.9004474614092948, 'mass_2_source': 1.874485926573377, 's1_z': -0.02619723183791243, 's2_z': 0.007316814448261114, 'cos_iota': -0.6268467979651628, 'd_L': 179.89396618251283, 't_c': 0.02947453386037563, 'phase_c': 6.218394076944833, 'psi': 1.0286891174782817, 'ra': 3.3393355213797236, 'sin_dec': -0.8437110478640069, 'q': 0.986339251485192, 'M_c': 1.709877119862579, 'eta': 0.24998817551725036, 'iota': Array(2.2482959, dtype=float64, weak_type=True), 'dec': Array(-1.00415943, dtype=float64, weak_type=True), 'lambda_1': 15.79155334437155, 'lambda_2': 18.473689104219368, 'H1_SNR': 28.96416749081256, 'L1_SNR': 22.239331806159523, 'V1_SNR': 7.243491293721361, 'network_SNR': 37.228739486350044, 'epoch': 126.0, 'gmst': 2.7288901910520846, 'duration': 128.0}
Constructing reference waveforms. . .
Time for reference waveforms: 0.506420373916626 seconds
Time for h_sky_low and h_sky_center: 5.394190549850464 seconds
Going to compute the masks . . .
Time taken for f_index_array calculation is 0.710057258605957
Going to compute coefficients . . .
Time for computing coefficients: 119.91844987869263 seconds
Time for computing coefficients: 6.801942825317383 seconds
Time for computing coefficients: 6.761598348617554 seconds
['M_c', 'eta', 's1_z', 's2_z', 'lambda_1', 'lambda_2', 'd_L', 'phase_c', 'iota', 't_c', 'psi', 'ra', 'dec']
INFO: Using MALA as local sampler
Setting up a single Gaussian distribution
No autotune found, use input sampler_params
Training normalizing flow
Tuning global sampler:   0%|          | 0/200 [00:00<?, ?it/s]Tuning global sampler:   0%|          | 1/200 [02:00<6:41:16, 120.99s/it]Tuning global sampler:   1%|          | 2/200 [02:05<2:53:16, 52.51s/it] Tuning global sampler:   2%|▏         | 3/200 [02:10<1:40:36, 30.64s/it]Tuning global sampler:   2%|▏         | 4/200 [02:14<1:06:31, 20.36s/it]Tuning global sampler:   2%|▎         | 5/200 [02:20<48:42, 14.99s/it]  Tuning global sampler:   3%|▎         | 6/200 [02:24<37:01, 11.45s/it]Tuning global sampler:   4%|▎         | 7/200 [02:29<29:33,  9.19s/it]Tuning global sampler:   4%|▍         | 8/200 [02:33<24:44,  7.73s/it]Tuning global sampler:   4%|▍         | 9/200 [02:38<21:27,  6.74s/it]Tuning global sampler:   5%|▌         | 10/200 [02:42<19:04,  6.02s/it]Tuning global sampler:   6%|▌         | 11/200 [02:47<17:35,  5.58s/it]Tuning global sampler:   6%|▌         | 12/200 [02:52<16:31,  5.27s/it]Tuning global sampler:   6%|▋         | 13/200 [02:56<15:45,  5.06s/it]Tuning global sampler:   7%|▋         | 14/200 [03:01<15:16,  4.93s/it]Tuning global sampler:   8%|▊         | 15/200 [03:05<14:55,  4.84s/it]Tuning global sampler:   8%|▊         | 16/200 [03:10<14:37,  4.77s/it]Tuning global sampler:   8%|▊         | 17/200 [03:15<14:25,  4.73s/it]Tuning global sampler:   9%|▉         | 18/200 [03:19<14:14,  4.70s/it]Tuning global sampler:  10%|▉         | 19/200 [03:24<14:06,  4.68s/it]Tuning global sampler:  10%|█         | 20/200 [03:29<14:47,  4.93s/it]Tuning global sampler:  10%|█         | 21/200 [03:34<14:26,  4.84s/it]Tuning global sampler:  11%|█         | 22/200 [03:39<14:07,  4.76s/it]Tuning global sampler:  12%|█▏        | 23/200 [03:43<13:52,  4.71s/it]Tuning global sampler:  12%|█▏        | 24/200 [03:48<13:32,  4.62s/it]Tuning global sampler:  12%|█▎        | 25/200 [03:52<13:16,  4.55s/it]Tuning global sampler:  13%|█▎        | 26/200 [03:56<13:02,  4.50s/it]Tuning global sampler:  14%|█▎        | 27/200 [04:01<12:52,  4.46s/it]Tuning global sampler:  14%|█▍        | 28/200 [04:05<12:45,  4.45s/it]Tuning global sampler:  14%|█▍        | 29/200 [04:10<12:37,  4.43s/it]Tuning global sampler:  15%|█▌        | 30/200 [04:14<12:30,  4.42s/it]Tuning global sampler:  16%|█▌        | 31/200 [04:18<12:24,  4.40s/it]Tuning global sampler:  16%|█▌        | 32/200 [04:23<12:18,  4.40s/it]Tuning global sampler:  16%|█▋        | 33/200 [04:27<12:11,  4.38s/it]Tuning global sampler:  17%|█▋        | 34/200 [04:31<12:05,  4.37s/it]Tuning global sampler:  18%|█▊        | 35/200 [04:36<12:01,  4.37s/it]Tuning global sampler:  18%|█▊        | 36/200 [04:40<11:57,  4.37s/it]Tuning global sampler:  18%|█▊        | 37/200 [04:45<11:53,  4.38s/it]Tuning global sampler:  19%|█▉        | 38/200 [04:49<11:49,  4.38s/it]Tuning global sampler:  20%|█▉        | 39/200 [04:54<12:29,  4.65s/it]Tuning global sampler:  20%|██        | 40/200 [04:59<12:11,  4.57s/it]Tuning global sampler:  20%|██        | 41/200 [05:03<12:02,  4.54s/it]Tuning global sampler:  21%|██        | 42/200 [05:07<11:49,  4.49s/it]Tuning global sampler:  22%|██▏       | 43/200 [05:12<11:40,  4.46s/it]Tuning global sampler:  22%|██▏       | 44/200 [05:16<11:30,  4.43s/it]Tuning global sampler:  22%|██▎       | 45/200 [05:21<11:22,  4.40s/it]Tuning global sampler:  23%|██▎       | 46/200 [05:25<11:16,  4.39s/it]Tuning global sampler:  24%|██▎       | 47/200 [05:29<11:11,  4.39s/it]Tuning global sampler:  24%|██▍       | 48/200 [05:34<11:06,  4.38s/it]Tuning global sampler:  24%|██▍       | 49/200 [05:38<11:03,  4.39s/it]Tuning global sampler:  25%|██▌       | 50/200 [05:42<10:58,  4.39s/it]Tuning global sampler:  26%|██▌       | 51/200 [05:47<10:53,  4.38s/it]Tuning global sampler:  26%|██▌       | 52/200 [05:51<10:48,  4.38s/it]Tuning global sampler:  26%|██▋       | 53/200 [05:56<10:43,  4.38s/it]Tuning global sampler:  27%|██▋       | 54/200 [06:00<10:41,  4.40s/it]Tuning global sampler:  28%|██▊       | 55/200 [06:04<10:34,  4.38s/it]