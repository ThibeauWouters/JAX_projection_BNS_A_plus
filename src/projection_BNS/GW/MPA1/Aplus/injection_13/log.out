Tue Apr  1 15:34:28 CEST 2025
NVIDIA H100
/gpfs/home6/twouters2/ninjax_dev/jim/src/jimgw/prior.py:94: UserWarning: As of jaxtyping version 0.2.24, jaxtyping now prefers the syntax
```
from jaxtyping import jaxtyped
# Use your favourite typechecker: usually one of the two lines below.
from typeguard import typechecked as typechecker
from beartype import beartype as typechecker

@jaxtyped(typechecker=typechecker)
def foo(...):
```
and the old double-decorator syntax
```
@jaxtyped
@typechecker
def foo(...):
```
should no longer be used. (It will continue to work as it did before, but the new approach will produce more readable error messages.)
In particular note that `typechecker` must be passed via keyword argument; the following is not valid:
```
@jaxtyped(typechecker)
def foo(...):
```

  class Uniform(Prior):
/gpfs/home6/twouters2/ninjax_dev/jim/src/jimgw/prior.py:149: UserWarning: As of jaxtyping version 0.2.24, jaxtyping now prefers the syntax
```
from jaxtyping import jaxtyped
# Use your favourite typechecker: usually one of the two lines below.
from typeguard import typechecked as typechecker
from beartype import beartype as typechecker

@jaxtyped(typechecker=typechecker)
def foo(...):
```
and the old double-decorator syntax
```
@jaxtyped
@typechecker
def foo(...):
```
should no longer be used. (It will continue to work as it did before, but the new approach will produce more readable error messages.)
In particular note that `typechecker` must be passed via keyword argument; the following is not valid:
```
@jaxtyped(typechecker)
def foo(...):
```

  class Unconstrained_Uniform(Prior):
/gpfs/home6/twouters2/ninjax_dev/jim/src/jimgw/prior.py:263: UserWarning: As of jaxtyping version 0.2.24, jaxtyping now prefers the syntax
```
from jaxtyping import jaxtyped
# Use your favourite typechecker: usually one of the two lines below.
from typeguard import typechecked as typechecker
from beartype import beartype as typechecker

@jaxtyped(typechecker=typechecker)
def foo(...):
```
and the old double-decorator syntax
```
@jaxtyped
@typechecker
def foo(...):
```
should no longer be used. (It will continue to work as it did before, but the new approach will produce more readable error messages.)
In particular note that `typechecker` must be passed via keyword argument; the following is not valid:
```
@jaxtyped(typechecker)
def foo(...):
```

  class AlignedSpin(Prior):
/gpfs/home6/twouters2/ninjax_dev/jim/src/jimgw/prior.py:377: UserWarning: As of jaxtyping version 0.2.24, jaxtyping now prefers the syntax
```
from jaxtyping import jaxtyped
# Use your favourite typechecker: usually one of the two lines below.
from typeguard import typechecked as typechecker
from beartype import beartype as typechecker

@jaxtyped(typechecker=typechecker)
def foo(...):
```
and the old double-decorator syntax
```
@jaxtyped
@typechecker
def foo(...):
```
should no longer be used. (It will continue to work as it did before, but the new approach will produce more readable error messages.)
In particular note that `typechecker` must be passed via keyword argument; the following is not valid:
```
@jaxtyped(typechecker)
def foo(...):
```

  class PowerLaw(Prior):
/gpfs/home6/twouters2/ninjax_dev/jim/src/jimgw/single_event/detector.py:496: UserWarning: As of jaxtyping version 0.2.24, jaxtyping now prefers the syntax
```
from jaxtyping import jaxtyped
# Use your favourite typechecker: usually one of the two lines below.
from typeguard import typechecked as typechecker
from beartype import beartype as typechecker

@jaxtyped(typechecker=typechecker)
def foo(...):
```
and the old double-decorator syntax
```
@jaxtyped
@typechecker
def foo(...):
```
should no longer be used. (It will continue to work as it did before, but the new approach will produce more readable error messages.)
In particular note that `typechecker` must be passed via keyword argument; the following is not valid:
```
@jaxtyped(typechecker)
def foo(...):
```

  def load_psd(
15:34 ninjax INFO    : Checking and setting outdir
15:34 ninjax INFO    : Found generation prior file ./Aplus/injection_13/generation_prior.prior
15:34 ninjax INFO    : The outdir is set to ./Aplus/injection_13
15:34 ninjax INFO    : Loading the given config
15:34 ninjax WARNING : Unrecognized keys given: {'n_max_examples', 'generation_seed'}. These will be ignored
15:34 ninjax INFO    : Arguments loaded into the config: {'likelihood': 'HeterodynedTransientLikelihoodFD', 'gw_injection': 'True', 'gw_load_existing_injection': 'False', 'gw_dump_injection_data': 'False', 'gw_SNR_threshold_low': '30.0', 'gw_SNR_threshold_high': '100', 'waveform_approximant': 'IMRPhenomD_NRTidalv2', 'waveform_approximant_1': 'None', 'waveform_approximant_2': 'None', 'gw_overlapping_tight_priors': 'False', 'ifos': 'H1,L1,V1', 'eos_file': '/home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/MPA1.npz', 'fmin': '20.0', 'fref': '20.0', 'fmax': '2048.0', 'duration': 'None', 'post_trigger_duration': '2.0', 'trigger_time': '1187008882.4', 'psd_file_H1': '/home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/AplusDesign_PSD.txt', 'psd_file_L1': '/home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/AplusDesign_PSD.txt', 'psd_file_V1': '/home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/avirgo_O5high_NEW_PSD.txt', 'psd_file_ET1': '/home/twouters2/psds/ET_D_psd.txt', 'psd_file_ET2': '/home/twouters2/psds/ET_D_psd.txt', 'psd_file_ET3': '/home/twouters2/psds/ET_D_psd.txt', 'psd_file_CE': '/home/twouters2/psds/CE_psd.txt', 'data_file_H1': 'None', 'data_file_L1': 'None', 'data_file_V1': 'None', 'data_file_ET1': 'None', 'data_file_ET2': 'None', 'data_file_ET3': 'None', 'relative_binning_binsize': '1000', 'relative_binning_ref_params_equal_true_params': 'True', 'relative_binning_ref_params': 'None', 'transforms': 'q_to_eta,cos_iota_to_iota,sin_dec_to_dec', 'gw_kwargs': 'None', 'filters': 'None', 'tmin': '0.05', 'tmax': '15.0', 'em_injection': 'False', 'em_trigger_time': '0.0', 'em_data_path': 'None', 'KN_model_name': 'None', 'KN_class_name': 'None', 'KN_model_dir': 'None', 'GRB_model_name': 'None', 'GRB_class_name': 'None', 'GRB_model_dir': 'None', 'detection_limit': 'None', 'n_loop_training': '200', 'n_loop_production': '10', 'n_local_steps': '100', 'n_global_steps': '1_000', 'n_epochs': '25', 'n_chains': '1_000', 'learning_rate': '0.001', 'max_samples': '50000', 'momentum': '0.9', 'batch_size': '30000', 'use_global': 'True', 'keep_quantile': '0.0', 'train_thinning': '10', 'output_thinning': '50', 'n_sample_max': '10000', 'verbose': 'False', 'save_training_chains': 'False', 'eps_mass_matrix': '1e-5', 'use_scheduler': 'True', 'use_temperature': 'False', 'which_temperature_schedule': 'exponential', 'starting_temperature': '2.0', 'stop_tempering_iteration': '75', 'stopping_criterion_global_acc': '0.10', 'stopping_criterion_loss': '-inf', 'seed': '123', 'sampling_seed': '123', 'injection_generation_seed': 'None', 'num_layers': '10', 'hidden_size': '128,128', 'num_bins': '8', 'nf_model_kwargs': 'None', 'run_sampler': 'True', 'keys_to_plot': 'M_c, q, s1_z, s2_z, lambda_1, lambda_2, d_L, t_c, phase_c, iota, psi, ra, dec'}
15:34 ninjax INFO    : Complete config file written to /gpfs/home6/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/GW/MPA1/Aplus/injection_13/complete_config.json
15:34 ninjax INFO    : No injection_generation_seed specified. Generating a random injection_generation_seed: 123673
15:34 ninjax INFO    : Loading the priors
15:34 ninjax INFO    : Setting up the prior
15:34 ninjax INFO    :    Mc_prior = Uniform(0.98, 2.6, naming=["M_c"])
15:34 ninjax INFO    :    q_prior = Uniform(0.125, 1.0, naming=["q"])
15:34 ninjax INFO    :    s1_z_prior = Uniform(-0.05, 0.05, naming=["s1_z"])
15:34 ninjax INFO    :    s2_z_prior = Uniform(-0.05, 0.05, naming=["s2_z"])
15:34 ninjax INFO    :    lambda1_prior = Uniform(0.0, 5000.0, naming=["lambda_1"])
15:34 ninjax INFO    :    lambda2_prior = Uniform(0.0, 5000.0, naming=["lambda_2"])
15:34 ninjax INFO    :    cos_iota_prior = Uniform(-1.0, 1.0, naming=["cos_iota"])
15:34 ninjax INFO    :    dL_prior = PowerLaw(10.0, 1000.0, 2.0, naming=["d_L"])
15:34 ninjax INFO    :    t_c_prior = Uniform(-0.1, 0.1, naming=["t_c"])
15:34 ninjax INFO    :    phase_c_prior = Uniform(0.0, 2 * jnp.pi, naming=["phase_c"])
15:34 ninjax INFO    :    psi_prior = Uniform(0.0, jnp.pi, naming=["psi"])
15:34 ninjax INFO    :    ra_prior = Uniform(0.0, 2 * jnp.pi, naming=["ra"])
15:34 ninjax INFO    :    sin_dec_prior = Uniform(-1.0, 1.0, naming=["sin_dec"])
15:34 ninjax INFO    : Setting up the generation prior
15:34 ninjax INFO    :    mass_1_source_prior = Uniform(1.0, 2.468645554845655, naming=["mass_1_source"])
15:34 ninjax INFO    :    mass_2_source_prior = Uniform(1.0, 2.468645554845655, naming=["mass_2_source"])
15:34 ninjax INFO    :    s1_z_prior = Uniform(-0.05, 0.05, naming=["s1_z"])
15:34 ninjax INFO    :    s2_z_prior = Uniform(-0.05, 0.05, naming=["s2_z"])
15:34 ninjax INFO    :    cos_iota_prior = Uniform(-1.0, 1.0, naming=["cos_iota"])
15:34 ninjax INFO    :    dL_prior = PowerLaw(10.0, 460.0, 2.0, naming=["d_L"])
15:34 ninjax INFO    :    t_c_prior = Uniform(-0.1, 0.1, naming=["t_c"])
15:34 ninjax INFO    :    phase_c_prior = Uniform(0.0, 2 * jnp.pi, naming=["phase_c"])
15:34 ninjax INFO    :    psi_prior = Uniform(0.0, jnp.pi, naming=["psi"])
15:34 ninjax INFO    :    ra_prior = Uniform(0.0, 2 * jnp.pi, naming=["ra"])
15:34 ninjax INFO    :    sin_dec_prior = Uniform(-1.0, 1.0, naming=["sin_dec"])
15:34 ninjax INFO    : Finished prior setup
15:34 ninjax INFO    : Setting the transforms
15:34 ninjax INFO    : Raw transforms list is q_to_eta,cos_iota_to_iota,sin_dec_to_dec
15:34 ninjax INFO    : transforms_str_list has 3 elements
15:34 ninjax INFO    : DEBUG: Checking that all_transforms is OK: the list is ['binary_Love', 'binary_love_fit', 'cos_iota1_to_iota1', 'cos_iota2_to_iota2', 'cos_iota_to_iota', 'log_lambda_to_lambda', 'm1_m2_to_Mc_q', 'q1_to_eta1', 'q2_to_eta2', 'q_to_eta', 'sin_dec1_to_dec1', 'sin_dec2_to_dec2', 'sin_dec_to_dec', 'spin_sphere_to_cartesian_s1', 'spin_sphere_to_cartesian_s2', 'swap_lambdas_eos', 't_c_dt_to_tcs']
15:34 ninjax INFO    : Setting the likelihood
15:34 ninjax INFO    : GW likelihood provided, setting up the GW pipe
15:34 ninjax INFO    : eos_file is /home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/MPA1.npz
15:34 ninjax INFO    : Using eos_file /home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/MPA1.npz for BNS injections
15:34 ninjax INFO    : Note: No specific waveform approximant 1 so defaulting to IMRPhenomD_NRTidalv2
15:34 ninjax INFO    : self.is_BNS_run is True
15:34 ninjax INFO    : Using IMRPhenomD_NRTidalv2 waveform. Therefore, we will use no taper as the reference waveform for the likelihood if relative binning is used
15:34 ninjax INFO    : GW run is an injection
15:34 ninjax INFO    : Setting up GW injection . . . 
15:34 ninjax INFO    : The SNR thresholds are: 30.0 - 100.0
15:34 ninjax INFO    : Generating new injection
15:34 ninjax INFO    : Sanity check: generated parameters:
15:34 ninjax INFO    : {'mass_1_source': 2.0672907826055535, 'mass_2_source': 1.3257686126534358, 's1_z': -0.03859687939045671, 's2_z': 0.0001227060072028982, 'cos_iota': 0.7233434024503445, 'd_L': 315.0312929507364, 't_c': 0.05473375771609887, 'phase_c': 2.469956812514299, 'psi': 2.5666466289908456, 'ra': 5.226452165699668, 'sin_dec': -0.21895000637308293}
15:34 ninjax INFO    : Computing lambdas from EOS file /home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/MPA1.npz . . . 
15:34 ninjax INFO    : Injected lambda_1: 37.36987787707955
15:34 ninjax INFO    : Injected lambda_2: 699.1731067148115
15:34 ninjax INFO    : Duration is not specified in the config. Computed chirp time: for fmin = 20.0 and M_c = 1.5362683596811182 is 128.0
15:34 ninjax INFO    : After transforms, the injection parameters are:
15:34 ninjax INFO    : {'mass_1_source': 2.0672907826055535, 'mass_2_source': 1.3257686126534358, 's1_z': -0.03859687939045671, 's2_z': 0.0001227060072028982, 'cos_iota': 0.7233434024503445, 'd_L': 315.0312929507364, 't_c': 0.05473375771609887, 'phase_c': 2.469956812514299, 'psi': 2.5666466289908456, 'ra': 5.226452165699668, 'sin_dec': -0.21895000637308293, 'q': 0.6413072722079646, 'M_c': 1.5362683596811182, 'eta': 0.23805997146327043, 'iota': Array(0.76216412, dtype=float64, weak_type=True), 'dec': Array(-0.22073824, dtype=float64, weak_type=True), 'lambda_1': 37.36987787707955, 'lambda_2': 699.1731067148115}
15:34 ninjax INFO    : The trial injection parameters are {'M_c': 1.5362683596811182, 'eta': 0.23805997146327043, 's1_z': -0.03859687939045671, 's2_z': 0.0001227060072028982, 'lambda_1': 37.36987787707955, 'lambda_2': 699.1731067148115, 'd_L': 315.0312929507364, 'phase_c': 2.469956812514299, 'iota': 0.7621641249575476, 't_c': 0.05473375771609887, 'psi': 2.5666466289908456, 'ra': 5.226452165699668, 'dec': -0.22073823619983712}
15:34 ninjax INFO    : Injecting signals . . .
15:35 ninjax INFO    : self.ifos
15:35 ninjax INFO    : [GroundBased2G(H1), GroundBased2G(L1), GroundBased2G(V1)]
15:35 ninjax INFO    : Signal injected in ifo H1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
15:35 ninjax INFO    : [-6.36315063e-23-3.90883213e-23j -7.92813557e-23-5.06715377e-23j
 -3.85003932e-23+2.39881282e-23j ...
  5.39276234e-24+2.45611913e-24j  1.84029243e-23-8.43609062e-24j
  3.40736080e-24+7.17846270e-24j]
15:35 ninjax INFO    : [1.44906511e-46 1.44667215e-46 1.44435812e-46 ... 2.17775889e-47
 2.17777440e-47 2.17778992e-47]
15:35 ninjax INFO    : Signal injected in ifo L1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
15:35 ninjax INFO    : [ 2.07718283e-23-7.44314173e-23j -4.26011025e-23+4.11590760e-23j
  1.58923338e-23+5.77243398e-23j ...
  1.86703625e-23-1.85004590e-23j  2.39227072e-24+2.92689593e-23j
 -6.76490301e-24-1.27936851e-23j]
15:35 ninjax INFO    : [1.44906511e-46 1.44667215e-46 1.44435812e-46 ... 2.17775889e-47
 2.17777440e-47 2.17778992e-47]
15:35 ninjax INFO    : Signal injected in ifo V1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
15:35 ninjax INFO    : [-2.65382614e-23-9.73174417e-24j -3.10339227e-23+1.70735365e-23j
 -4.97758309e-23+3.37959955e-23j ...
  2.68093527e-23+9.93100495e-24j  5.52060851e-23-5.33113432e-24j
 -2.70040822e-23-1.64197717e-23j]
15:35 ninjax INFO    : [1.43183556e-46 1.42935095e-46 1.42688205e-46 ... 6.39786094e-47
 6.39790724e-47 6.39795354e-47]
15:35 ninjax INFO    : SNR for ifo H1 is 5.48931842788431
15:35 ninjax INFO    : SNR for ifo L1 is 10.803743630141506
15:35 ninjax INFO    : SNR for ifo V1 is 8.275384490698661
15:35 ninjax INFO    : The network SNR is 14.674313670404807
15:35 ninjax INFO    : The network SNR does not pass the threshold, trying again
15:35 ninjax INFO    : Generating new injection
15:35 ninjax INFO    : Sanity check: generated parameters:
15:35 ninjax INFO    : {'mass_1_source': 1.0983495655273297, 'mass_2_source': 2.328372969254546, 's1_z': -0.04967299769494402, 's2_z': -0.033140635541250574, 'cos_iota': -0.5462827565490227, 'd_L': 336.58480843435456, 't_c': -0.01632929347766869, 'phase_c': 1.4671593974192967, 'psi': 2.5587453228120145, 'ra': 5.81719120281748, 'sin_dec': -0.04240782027979373}
15:35 ninjax INFO    : Computing lambdas from EOS file /home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/MPA1.npz . . . 
15:35 ninjax INFO    : Injected lambda_1: 11.420742185442672
15:35 ninjax INFO    : Injected lambda_2: 1937.7290861092042
15:35 ninjax INFO    : Duration is not specified in the config. Computed chirp time: for fmin = 20.0 and M_c = 1.4775219471384444 is 128.0
15:35 ninjax INFO    : After transforms, the injection parameters are:
15:35 ninjax INFO    : {'mass_1_source': 2.328372969254546, 'mass_2_source': 1.0983495655273297, 's1_z': -0.04967299769494402, 's2_z': -0.033140635541250574, 'cos_iota': -0.5462827565490227, 'd_L': 336.58480843435456, 't_c': -0.01632929347766869, 'phase_c': 1.4671593974192967, 'psi': 2.5587453228120145, 'ra': 5.81719120281748, 'sin_dec': -0.04240782027979373, 'q': 0.47172406656094207, 'M_c': 1.4775219471384444, 'eta': 0.21778865367550293, 'iota': Array(2.14871614, dtype=float64, weak_type=True), 'dec': Array(-0.04242054, dtype=float64, weak_type=True), 'lambda_1': 11.420742185442672, 'lambda_2': 1937.7290861092042}
15:35 ninjax INFO    : The trial injection parameters are {'M_c': 1.4775219471384444, 'eta': 0.21778865367550293, 's1_z': -0.04967299769494402, 's2_z': -0.033140635541250574, 'lambda_1': 11.420742185442672, 'lambda_2': 1937.7290861092042, 'd_L': 336.58480843435456, 'phase_c': 1.4671593974192967, 'iota': 2.1487161432938535, 't_c': -0.01632929347766869, 'psi': 2.5587453228120145, 'ra': 5.81719120281748, 'dec': -0.042420541779329725}
15:35 ninjax INFO    : Injecting signals . . .
15:35 ninjax INFO    : self.ifos
15:35 ninjax INFO    : [GroundBased2G(H1), GroundBased2G(L1), GroundBased2G(V1)]
15:35 ninjax INFO    : Signal injected in ifo H1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
15:35 ninjax INFO    : [-6.69967840e-23-3.70727192e-23j -8.10243109e-23-4.65219350e-23j
 -3.73067331e-23+2.87766927e-23j ...
  5.39276234e-24+2.45611913e-24j  1.84029243e-23-8.43609062e-24j
  3.40736080e-24+7.17846270e-24j]
15:35 ninjax INFO    : [1.44906511e-46 1.44667215e-46 1.44435812e-46 ... 2.17775889e-47
 2.17777440e-47 2.17778992e-47]
15:35 ninjax INFO    : Signal injected in ifo L1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
15:35 ninjax INFO    : [ 2.29851437e-23-8.17196229e-23j -4.55631978e-23+3.43345748e-23j
  9.53235361e-24+5.46778502e-23j ...
  1.86703625e-23-1.85004590e-23j  2.39227072e-24+2.92689593e-23j
 -6.76490301e-24-1.27936851e-23j]
15:35 ninjax INFO    : [1.44906511e-46 1.44667215e-46 1.44435812e-46 ... 2.17775889e-47
 2.17777440e-47 2.17778992e-47]
15:35 ninjax INFO    : Signal injected in ifo V1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
15:35 ninjax INFO    : [-2.18620091e-23-2.47336843e-24j -2.24212332e-23+2.01577013e-23j
 -4.08679828e-23+3.08845396e-23j ...
  2.68093527e-23+9.93100495e-24j  5.52060851e-23-5.33113432e-24j
 -2.70040822e-23-1.64197717e-23j]
15:35 ninjax INFO    : [1.43183556e-46 1.42935095e-46 1.42688205e-46 ... 6.39786094e-47
 6.39790724e-47 6.39795354e-47]
15:35 ninjax INFO    : SNR for ifo H1 is 5.995016746303421
15:35 ninjax INFO    : SNR for ifo L1 is 5.616253268024376
15:35 ninjax INFO    : SNR for ifo V1 is 7.666439846369388
15:35 ninjax INFO    : The network SNR is 11.236406297257734
15:35 ninjax INFO    : The network SNR does not pass the threshold, trying again
15:35 ninjax INFO    : Generating new injection
15:35 ninjax INFO    : Sanity check: generated parameters:
15:35 ninjax INFO    : {'mass_1_source': 1.9608839433325, 'mass_2_source': 2.282667726399115, 's1_z': -0.007312374353902348, 's2_z': -0.04868485219956973, 'cos_iota': -0.18997352405263523, 'd_L': 294.03904469896725, 't_c': 0.07442944331917309, 'phase_c': 2.7809421749144896, 'psi': 2.356507137999426, 'ra': 1.1016437206938139, 'sin_dec': 0.07349641856590061}
15:35 ninjax INFO    : Computing lambdas from EOS file /home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/MPA1.npz . . . 
15:35 ninjax INFO    : Injected lambda_1: 14.471325677303616
15:35 ninjax INFO    : Injected lambda_2: 57.08909710848287
15:35 ninjax INFO    : Duration is not specified in the config. Computed chirp time: for fmin = 20.0 and M_c = 1.9630315174209374 is 128.0
15:35 ninjax INFO    : After transforms, the injection parameters are:
15:35 ninjax INFO    : {'mass_1_source': 2.282667726399115, 'mass_2_source': 1.9608839433325, 's1_z': -0.007312374353902348, 's2_z': -0.04868485219956973, 'cos_iota': -0.18997352405263523, 'd_L': 294.03904469896725, 't_c': 0.07442944331917309, 'phase_c': 2.7809421749144896, 'psi': 2.356507137999426, 'ra': 1.1016437206938139, 'sin_dec': 0.07349641856590061, 'q': 0.859031702535951, 'M_c': 1.9630315174209374, 'eta': 0.2485624951257602, 'iota': Array(1.76193151, dtype=float64, weak_type=True), 'dec': Array(0.07356275, dtype=float64, weak_type=True), 'lambda_1': 14.471325677303616, 'lambda_2': 57.08909710848287}
15:35 ninjax INFO    : The trial injection parameters are {'M_c': 1.9630315174209374, 'eta': 0.2485624951257602, 's1_z': -0.007312374353902348, 's2_z': -0.04868485219956973, 'lambda_1': 14.471325677303616, 'lambda_2': 57.08909710848287, 'd_L': 294.03904469896725, 'phase_c': 2.7809421749144896, 'iota': 1.761931506217258, 't_c': 0.07442944331917309, 'psi': 2.356507137999426, 'ra': 1.1016437206938139, 'dec': 0.07356274781331783}
15:35 ninjax INFO    : Injecting signals . . .
15:35 ninjax INFO    : self.ifos
15:35 ninjax INFO    : [GroundBased2G(H1), GroundBased2G(L1), GroundBased2G(V1)]
15:35 ninjax INFO    : Signal injected in ifo H1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
15:35 ninjax INFO    : [-6.58237557e-23-3.56311118e-23j -7.96194314e-23-5.29576945e-23j
 -4.22925009e-23+2.88006859e-23j ...
  5.40215702e-24+2.46667438e-24j  1.84112722e-23-8.42468983e-24j
  3.41458627e-24+7.19060561e-24j]
15:35 ninjax INFO    : [1.44906511e-46 1.44667215e-46 1.44435812e-46 ... 2.17775889e-47
 2.17777440e-47 2.17778992e-47]
15:35 ninjax INFO    : Signal injected in ifo L1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
15:35 ninjax INFO    : [ 2.47429425e-23-8.26853951e-23j -4.93219700e-23+3.85424035e-23j
  1.52527711e-23+5.74640152e-23j ...
  1.86557458e-23-1.84971455e-23j  2.37740502e-24+2.92708639e-23j
 -6.77988228e-24-1.27932068e-23j]
15:35 ninjax INFO    : [1.44906511e-46 1.44667215e-46 1.44435812e-46 ... 2.17775889e-47
 2.17777440e-47 2.17778992e-47]
15:35 ninjax INFO    : Signal injected in ifo V1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
15:35 ninjax INFO    : [-2.35878578e-23-7.86283071e-24j -3.01518861e-23+2.11688590e-23j
 -4.15291342e-23+3.27935734e-23j ...
  2.67982768e-23+9.92557165e-24j  5.51955711e-23-5.33758771e-24j
 -2.70139407e-23-1.64271876e-23j]
15:35 ninjax INFO    : [1.43183556e-46 1.42935095e-46 1.42688205e-46 ... 6.39786094e-47
 6.39790724e-47 6.39795354e-47]
15:35 ninjax INFO    : SNR for ifo H1 is 8.783473238906277
15:35 ninjax INFO    : SNR for ifo L1 is 9.316126381142531
15:35 ninjax INFO    : SNR for ifo V1 is 6.050638023479171
15:35 ninjax INFO    : The network SNR is 14.161561826972846
15:35 ninjax INFO    : The network SNR does not pass the threshold, trying again
15:35 ninjax INFO    : Generating new injection
15:35 ninjax INFO    : Sanity check: generated parameters:
15:35 ninjax INFO    : {'mass_1_source': 1.8106539583132952, 'mass_2_source': 1.2280387891764062, 's1_z': 0.025373825521005852, 's2_z': 0.04462168567515826, 'cos_iota': 0.28140271431758856, 'd_L': 244.68916621353287, 't_c': -0.06759514087063137, 'phase_c': 2.1118144326209154, 'psi': 0.37057163201598076, 'ra': 1.617029951858324, 'sin_dec': 0.3001804745344616}
15:35 ninjax INFO    : Computing lambdas from EOS file /home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/MPA1.npz . . . 
15:35 ninjax INFO    : Injected lambda_1: 102.08058315709322
15:35 ninjax INFO    : Injected lambda_2: 1068.1896968954668
15:35 ninjax INFO    : Duration is not specified in the config. Computed chirp time: for fmin = 20.0 and M_c = 1.3647798606454675 is 256.0
15:35 ninjax INFO    : After transforms, the injection parameters are:
15:35 ninjax INFO    : {'mass_1_source': 1.8106539583132952, 'mass_2_source': 1.2280387891764062, 's1_z': 0.025373825521005852, 's2_z': 0.04462168567515826, 'cos_iota': 0.28140271431758856, 'd_L': 244.68916621353287, 't_c': -0.06759514087063137, 'phase_c': 2.1118144326209154, 'psi': 0.37057163201598076, 'ra': 1.617029951858324, 'sin_dec': 0.3001804745344616, 'q': 0.6782294228767926, 'M_c': 1.3647798606454675, 'eta': 0.24080969328309154, 'iota': Array(1.28554074, dtype=float64, weak_type=True), 'dec': Array(0.30488185, dtype=float64, weak_type=True), 'lambda_1': 102.08058315709322, 'lambda_2': 1068.1896968954668}
15:35 ninjax INFO    : The trial injection parameters are {'M_c': 1.3647798606454675, 'eta': 0.24080969328309154, 's1_z': 0.025373825521005852, 's2_z': 0.04462168567515826, 'lambda_1': 102.08058315709322, 'lambda_2': 1068.1896968954668, 'd_L': 244.68916621353287, 'phase_c': 2.1118144326209154, 'iota': 1.2855407448330785, 't_c': -0.06759514087063137, 'psi': 0.37057163201598076, 'ra': 1.617029951858324, 'dec': 0.3048818483628416}
15:35 ninjax INFO    : Injecting signals . . .
15:35 ninjax INFO    : self.ifos
15:35 ninjax INFO    : [GroundBased2G(H1), GroundBased2G(L1), GroundBased2G(V1)]
15:35 ninjax INFO    : Signal injected in ifo H1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.           20.00390625   20.0078125  ... 2047.98828125
 2047.9921875  2047.99609375]
15:35 ninjax INFO    : [-2.73730189e-23-1.07535352e-23j  7.10391361e-23-3.31875523e-23j
  5.62228906e-24+1.70671257e-22j ...
  2.25422483e-23-6.55111347e-24j  1.46120288e-23+4.92797357e-23j
  5.10662865e-23-3.46449217e-24j]
15:35 ninjax INFO    : [1.44906511e-46 1.44785671e-46 1.44667215e-46 ... 2.17778216e-47
 2.17778992e-47 2.17779767e-47]
15:35 ninjax INFO    : Signal injected in ifo L1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.           20.00390625   20.0078125  ... 2047.98828125
 2047.9921875  2047.99609375]
15:35 ninjax INFO    : [-6.97610580e-23-2.40414602e-23j  5.16342261e-23-1.45584471e-23j
 -1.52914053e-22+1.22810791e-23j ...
 -2.53741207e-23-4.32953499e-23j -2.41682042e-23-3.21319862e-23j
  7.93567389e-23-3.19354114e-24j]
15:35 ninjax INFO    : [1.44906511e-46 1.44785671e-46 1.44667215e-46 ... 2.17778216e-47
 2.17778992e-47 2.17779767e-47]
15:35 ninjax INFO    : Signal injected in ifo V1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.           20.00390625   20.0078125  ... 2047.98828125
 2047.9921875  2047.99609375]
15:35 ninjax INFO    : [-6.14389669e-23-4.19046201e-23j  6.25400506e-23+2.97872433e-23j
 -3.54234394e-23-5.52644630e-23j ...
 -2.60527474e-23+4.89183385e-23j  3.97766966e-23+4.60130803e-23j
 -4.17488685e-23+1.29686330e-22j]
15:35 ninjax INFO    : [1.43183556e-46 1.43058540e-46 1.42935095e-46 ... 6.39793039e-47
 6.39795354e-47 6.39797668e-47]
