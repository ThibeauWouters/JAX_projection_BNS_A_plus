Tue Apr  1 15:34:32 CEST 2025
NVIDIA H100
/gpfs/home6/twouters2/ninjax_dev/jim/src/jimgw/prior.py:94: UserWarning: As of jaxtyping version 0.2.24, jaxtyping now prefers the syntax
```
from jaxtyping import jaxtyped
# Use your favourite typechecker: usually one of the two lines below.
from typeguard import typechecked as typechecker
from beartype import beartype as typechecker

@jaxtyped(typechecker=typechecker)
def foo(...):
```
and the old double-decorator syntax
```
@jaxtyped
@typechecker
def foo(...):
```
should no longer be used. (It will continue to work as it did before, but the new approach will produce more readable error messages.)
In particular note that `typechecker` must be passed via keyword argument; the following is not valid:
```
@jaxtyped(typechecker)
def foo(...):
```

  class Uniform(Prior):
/gpfs/home6/twouters2/ninjax_dev/jim/src/jimgw/prior.py:149: UserWarning: As of jaxtyping version 0.2.24, jaxtyping now prefers the syntax
```
from jaxtyping import jaxtyped
# Use your favourite typechecker: usually one of the two lines below.
from typeguard import typechecked as typechecker
from beartype import beartype as typechecker

@jaxtyped(typechecker=typechecker)
def foo(...):
```
and the old double-decorator syntax
```
@jaxtyped
@typechecker
def foo(...):
```
should no longer be used. (It will continue to work as it did before, but the new approach will produce more readable error messages.)
In particular note that `typechecker` must be passed via keyword argument; the following is not valid:
```
@jaxtyped(typechecker)
def foo(...):
```

  class Unconstrained_Uniform(Prior):
/gpfs/home6/twouters2/ninjax_dev/jim/src/jimgw/prior.py:263: UserWarning: As of jaxtyping version 0.2.24, jaxtyping now prefers the syntax
```
from jaxtyping import jaxtyped
# Use your favourite typechecker: usually one of the two lines below.
from typeguard import typechecked as typechecker
from beartype import beartype as typechecker

@jaxtyped(typechecker=typechecker)
def foo(...):
```
and the old double-decorator syntax
```
@jaxtyped
@typechecker
def foo(...):
```
should no longer be used. (It will continue to work as it did before, but the new approach will produce more readable error messages.)
In particular note that `typechecker` must be passed via keyword argument; the following is not valid:
```
@jaxtyped(typechecker)
def foo(...):
```

  class AlignedSpin(Prior):
/gpfs/home6/twouters2/ninjax_dev/jim/src/jimgw/prior.py:377: UserWarning: As of jaxtyping version 0.2.24, jaxtyping now prefers the syntax
```
from jaxtyping import jaxtyped
# Use your favourite typechecker: usually one of the two lines below.
from typeguard import typechecked as typechecker
from beartype import beartype as typechecker

@jaxtyped(typechecker=typechecker)
def foo(...):
```
and the old double-decorator syntax
```
@jaxtyped
@typechecker
def foo(...):
```
should no longer be used. (It will continue to work as it did before, but the new approach will produce more readable error messages.)
In particular note that `typechecker` must be passed via keyword argument; the following is not valid:
```
@jaxtyped(typechecker)
def foo(...):
```

  class PowerLaw(Prior):
/gpfs/home6/twouters2/ninjax_dev/jim/src/jimgw/single_event/detector.py:496: UserWarning: As of jaxtyping version 0.2.24, jaxtyping now prefers the syntax
```
from jaxtyping import jaxtyped
# Use your favourite typechecker: usually one of the two lines below.
from typeguard import typechecked as typechecker
from beartype import beartype as typechecker

@jaxtyped(typechecker=typechecker)
def foo(...):
```
and the old double-decorator syntax
```
@jaxtyped
@typechecker
def foo(...):
```
should no longer be used. (It will continue to work as it did before, but the new approach will produce more readable error messages.)
In particular note that `typechecker` must be passed via keyword argument; the following is not valid:
```
@jaxtyped(typechecker)
def foo(...):
```

  def load_psd(
15:34 ninjax INFO    : Checking and setting outdir
15:34 ninjax INFO    : Found generation prior file ./Aplus/injection_11/generation_prior.prior
15:34 ninjax INFO    : The outdir is set to ./Aplus/injection_11
15:34 ninjax INFO    : Loading the given config
15:34 ninjax WARNING : Unrecognized keys given: {'generation_seed', 'n_max_examples'}. These will be ignored
15:34 ninjax INFO    : Arguments loaded into the config: {'likelihood': 'HeterodynedTransientLikelihoodFD', 'gw_injection': 'True', 'gw_load_existing_injection': 'False', 'gw_dump_injection_data': 'False', 'gw_SNR_threshold_low': '30.0', 'gw_SNR_threshold_high': '100', 'waveform_approximant': 'IMRPhenomD_NRTidalv2', 'waveform_approximant_1': 'None', 'waveform_approximant_2': 'None', 'gw_overlapping_tight_priors': 'False', 'ifos': 'H1,L1,V1', 'eos_file': '/home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/MPA1.npz', 'fmin': '20.0', 'fref': '20.0', 'fmax': '2048.0', 'duration': 'None', 'post_trigger_duration': '2.0', 'trigger_time': '1187008882.4', 'psd_file_H1': '/home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/AplusDesign_PSD.txt', 'psd_file_L1': '/home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/AplusDesign_PSD.txt', 'psd_file_V1': '/home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/avirgo_O5high_NEW_PSD.txt', 'psd_file_ET1': '/home/twouters2/psds/ET_D_psd.txt', 'psd_file_ET2': '/home/twouters2/psds/ET_D_psd.txt', 'psd_file_ET3': '/home/twouters2/psds/ET_D_psd.txt', 'psd_file_CE': '/home/twouters2/psds/CE_psd.txt', 'data_file_H1': 'None', 'data_file_L1': 'None', 'data_file_V1': 'None', 'data_file_ET1': 'None', 'data_file_ET2': 'None', 'data_file_ET3': 'None', 'relative_binning_binsize': '1000', 'relative_binning_ref_params_equal_true_params': 'True', 'relative_binning_ref_params': 'None', 'transforms': 'q_to_eta,cos_iota_to_iota,sin_dec_to_dec', 'gw_kwargs': 'None', 'filters': 'None', 'tmin': '0.05', 'tmax': '15.0', 'em_injection': 'False', 'em_trigger_time': '0.0', 'em_data_path': 'None', 'KN_model_name': 'None', 'KN_class_name': 'None', 'KN_model_dir': 'None', 'GRB_model_name': 'None', 'GRB_class_name': 'None', 'GRB_model_dir': 'None', 'detection_limit': 'None', 'n_loop_training': '200', 'n_loop_production': '10', 'n_local_steps': '100', 'n_global_steps': '1_000', 'n_epochs': '25', 'n_chains': '1_000', 'learning_rate': '0.001', 'max_samples': '50000', 'momentum': '0.9', 'batch_size': '30000', 'use_global': 'True', 'keep_quantile': '0.0', 'train_thinning': '10', 'output_thinning': '50', 'n_sample_max': '10000', 'verbose': 'False', 'save_training_chains': 'False', 'eps_mass_matrix': '1e-5', 'use_scheduler': 'True', 'use_temperature': 'False', 'which_temperature_schedule': 'exponential', 'starting_temperature': '2.0', 'stop_tempering_iteration': '75', 'stopping_criterion_global_acc': '0.10', 'stopping_criterion_loss': '-inf', 'seed': '123', 'sampling_seed': '123', 'injection_generation_seed': 'None', 'num_layers': '10', 'hidden_size': '128,128', 'num_bins': '8', 'nf_model_kwargs': 'None', 'run_sampler': 'True', 'keys_to_plot': 'M_c, q, s1_z, s2_z, lambda_1, lambda_2, d_L, t_c, phase_c, iota, psi, ra, dec'}
15:34 ninjax INFO    : Complete config file written to /gpfs/home6/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/GW/MPA1/Aplus/injection_11/complete_config.json
15:34 ninjax INFO    : No injection_generation_seed specified. Generating a random injection_generation_seed: 199493
15:34 ninjax INFO    : Loading the priors
15:34 ninjax INFO    : Setting up the prior
15:34 ninjax INFO    :    Mc_prior = Uniform(0.98, 2.6, naming=["M_c"])
15:34 ninjax INFO    :    q_prior = Uniform(0.125, 1.0, naming=["q"])
15:34 ninjax INFO    :    s1_z_prior = Uniform(-0.05, 0.05, naming=["s1_z"])
15:34 ninjax INFO    :    s2_z_prior = Uniform(-0.05, 0.05, naming=["s2_z"])
15:34 ninjax INFO    :    lambda1_prior = Uniform(0.0, 5000.0, naming=["lambda_1"])
15:34 ninjax INFO    :    lambda2_prior = Uniform(0.0, 5000.0, naming=["lambda_2"])
15:34 ninjax INFO    :    cos_iota_prior = Uniform(-1.0, 1.0, naming=["cos_iota"])
15:34 ninjax INFO    :    dL_prior = PowerLaw(10.0, 1000.0, 2.0, naming=["d_L"])
15:34 ninjax INFO    :    t_c_prior = Uniform(-0.1, 0.1, naming=["t_c"])
15:34 ninjax INFO    :    phase_c_prior = Uniform(0.0, 2 * jnp.pi, naming=["phase_c"])
15:34 ninjax INFO    :    psi_prior = Uniform(0.0, jnp.pi, naming=["psi"])
15:34 ninjax INFO    :    ra_prior = Uniform(0.0, 2 * jnp.pi, naming=["ra"])
15:34 ninjax INFO    :    sin_dec_prior = Uniform(-1.0, 1.0, naming=["sin_dec"])
15:34 ninjax INFO    : Setting up the generation prior
15:34 ninjax INFO    :    mass_1_source_prior = Uniform(1.0, 2.468645554845655, naming=["mass_1_source"])
15:34 ninjax INFO    :    mass_2_source_prior = Uniform(1.0, 2.468645554845655, naming=["mass_2_source"])
15:34 ninjax INFO    :    s1_z_prior = Uniform(-0.05, 0.05, naming=["s1_z"])
15:34 ninjax INFO    :    s2_z_prior = Uniform(-0.05, 0.05, naming=["s2_z"])
15:34 ninjax INFO    :    cos_iota_prior = Uniform(-1.0, 1.0, naming=["cos_iota"])
15:34 ninjax INFO    :    dL_prior = PowerLaw(10.0, 460.0, 2.0, naming=["d_L"])
15:34 ninjax INFO    :    t_c_prior = Uniform(-0.1, 0.1, naming=["t_c"])
15:34 ninjax INFO    :    phase_c_prior = Uniform(0.0, 2 * jnp.pi, naming=["phase_c"])
15:34 ninjax INFO    :    psi_prior = Uniform(0.0, jnp.pi, naming=["psi"])
15:34 ninjax INFO    :    ra_prior = Uniform(0.0, 2 * jnp.pi, naming=["ra"])
15:34 ninjax INFO    :    sin_dec_prior = Uniform(-1.0, 1.0, naming=["sin_dec"])
15:34 ninjax INFO    : Finished prior setup
15:34 ninjax INFO    : Setting the transforms
15:34 ninjax INFO    : Raw transforms list is q_to_eta,cos_iota_to_iota,sin_dec_to_dec
15:34 ninjax INFO    : transforms_str_list has 3 elements
15:34 ninjax INFO    : DEBUG: Checking that all_transforms is OK: the list is ['binary_Love', 'binary_love_fit', 'cos_iota1_to_iota1', 'cos_iota2_to_iota2', 'cos_iota_to_iota', 'log_lambda_to_lambda', 'm1_m2_to_Mc_q', 'q1_to_eta1', 'q2_to_eta2', 'q_to_eta', 'sin_dec1_to_dec1', 'sin_dec2_to_dec2', 'sin_dec_to_dec', 'spin_sphere_to_cartesian_s1', 'spin_sphere_to_cartesian_s2', 'swap_lambdas_eos', 't_c_dt_to_tcs']
15:34 ninjax INFO    : Setting the likelihood
15:34 ninjax INFO    : GW likelihood provided, setting up the GW pipe
15:34 ninjax INFO    : eos_file is /home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/MPA1.npz
15:34 ninjax INFO    : Using eos_file /home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/MPA1.npz for BNS injections
15:34 ninjax INFO    : Note: No specific waveform approximant 1 so defaulting to IMRPhenomD_NRTidalv2
15:34 ninjax INFO    : self.is_BNS_run is True
15:34 ninjax INFO    : Using IMRPhenomD_NRTidalv2 waveform. Therefore, we will use no taper as the reference waveform for the likelihood if relative binning is used
15:34 ninjax INFO    : GW run is an injection
15:34 ninjax INFO    : Setting up GW injection . . . 
15:34 ninjax INFO    : The SNR thresholds are: 30.0 - 100.0
15:34 ninjax INFO    : Generating new injection
15:34 ninjax INFO    : Sanity check: generated parameters:
15:34 ninjax INFO    : {'mass_1_source': 1.279891998310885, 'mass_2_source': 1.1180676228267459, 's1_z': -0.02180649008475686, 's2_z': 0.02515409126857837, 'cos_iota': -0.7887744463275865, 'd_L': 278.04667193046816, 't_c': 0.09215715482725703, 'phase_c': 2.80958263531532, 'psi': 0.7184010295339665, 'ra': 5.1577264327516374, 'sin_dec': 0.6784661914997767}
15:34 ninjax INFO    : Computing lambdas from EOS file /home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/MPA1.npz . . . 
15:34 ninjax INFO    : Injected lambda_1: 851.0936849021582
15:34 ninjax INFO    : Injected lambda_2: 1764.987204857303
15:34 ninjax INFO    : Duration is not specified in the config. Computed chirp time: for fmin = 20.0 and M_c = 1.1063149937933947 is 256.0
15:34 ninjax INFO    : After transforms, the injection parameters are:
15:34 ninjax INFO    : {'mass_1_source': 1.279891998310885, 'mass_2_source': 1.1180676228267459, 's1_z': -0.02180649008475686, 's2_z': 0.02515409126857837, 'cos_iota': -0.7887744463275865, 'd_L': 278.04667193046816, 't_c': 0.09215715482725703, 'phase_c': 2.80958263531532, 'psi': 0.7184010295339665, 'ra': 5.1577264327516374, 'sin_dec': 0.6784661914997767, 'q': 0.8735640384519131, 'M_c': 1.1063149937933947, 'eta': 0.2488614708449146, 'iota': Array(2.47960897, dtype=float64, weak_type=True), 'dec': Array(0.74567276, dtype=float64, weak_type=True), 'lambda_1': 851.0936849021582, 'lambda_2': 1764.987204857303}
15:34 ninjax INFO    : The trial injection parameters are {'M_c': 1.1063149937933947, 'eta': 0.2488614708449146, 's1_z': -0.02180649008475686, 's2_z': 0.02515409126857837, 'lambda_1': 851.0936849021582, 'lambda_2': 1764.987204857303, 'd_L': 278.04667193046816, 'phase_c': 2.80958263531532, 'iota': 2.4796089670389594, 't_c': 0.09215715482725703, 'psi': 0.7184010295339665, 'ra': 5.1577264327516374, 'dec': 0.7456727556048935}
15:34 ninjax INFO    : Injecting signals . . .
15:35 ninjax INFO    : self.ifos
15:35 ninjax INFO    : [GroundBased2G(H1), GroundBased2G(L1), GroundBased2G(V1)]
15:35 ninjax INFO    : Signal injected in ifo H1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.           20.00390625   20.0078125  ... 2047.98828125
 2047.9921875  2047.99609375]
15:35 ninjax INFO    : [-2.77791158e-23-1.23111940e-23j  6.99929318e-23-3.64081298e-23j
  1.31441798e-24+1.75372895e-22j ...
  2.25422483e-23-6.55111347e-24j  1.46120288e-23+4.92797357e-23j
  5.10662865e-23-3.46449217e-24j]
15:35 ninjax INFO    : [1.44906511e-46 1.44785671e-46 1.44667215e-46 ... 2.17778216e-47
 2.17778992e-47 2.17779767e-47]
15:35 ninjax INFO    : Signal injected in ifo L1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.           20.00390625   20.0078125  ... 2047.98828125
 2047.9921875  2047.99609375]
15:35 ninjax INFO    : [-6.24720501e-23-2.28972012e-23j  4.80576686e-23-1.89962992e-23j
 -1.52318518e-22+1.39608986e-23j ...
 -2.53741207e-23-4.32953499e-23j -2.41682042e-23-3.21319862e-23j
  7.93567389e-23-3.19354114e-24j]
15:35 ninjax INFO    : [1.44906511e-46 1.44785671e-46 1.44667215e-46 ... 2.17778216e-47
 2.17778992e-47 2.17779767e-47]
15:35 ninjax INFO    : Signal injected in ifo V1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.           20.00390625   20.0078125  ... 2047.98828125
 2047.9921875  2047.99609375]
15:35 ninjax INFO    : [-6.18487249e-23-3.91048441e-23j  6.72415036e-23+2.86272388e-23j
 -3.88748394e-23-5.87996680e-23j ...
 -2.60527474e-23+4.89183385e-23j  3.97766966e-23+4.60130803e-23j
 -4.17488685e-23+1.29686330e-22j]
15:35 ninjax INFO    : [1.43183556e-46 1.43058540e-46 1.42935095e-46 ... 6.39793039e-47
 6.39795354e-47 6.39797668e-47]
15:35 ninjax INFO    : SNR for ifo H1 is 8.579349508290349
15:35 ninjax INFO    : SNR for ifo L1 is 6.831191126117384
15:35 ninjax INFO    : SNR for ifo V1 is 5.5768219590776935
15:35 ninjax INFO    : The network SNR is 12.303306602299966
15:35 ninjax INFO    : The network SNR does not pass the threshold, trying again
15:35 ninjax INFO    : Generating new injection
15:35 ninjax INFO    : Sanity check: generated parameters:
15:35 ninjax INFO    : {'mass_1_source': 1.5695643891968194, 'mass_2_source': 1.8491745557167492, 's1_z': -0.01289339748028704, 's2_z': -0.044651974173985566, 'cos_iota': 0.9257954865629623, 'd_L': 311.156085325912, 't_c': 0.037336176501672064, 'phase_c': 1.7569304899532918, 'psi': 1.7793333821768123, 'ra': 2.9733450612264347, 'sin_dec': -0.9665144346691039}
15:35 ninjax INFO    : Computing lambdas from EOS file /home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/MPA1.npz . . . 
15:35 ninjax INFO    : Injected lambda_1: 88.03177464613387
15:35 ninjax INFO    : Injected lambda_2: 259.28459924880275
15:35 ninjax INFO    : Duration is not specified in the config. Computed chirp time: for fmin = 20.0 and M_c = 1.586315919671747 is 128.0
15:35 ninjax INFO    : After transforms, the injection parameters are:
15:35 ninjax INFO    : {'mass_1_source': 1.8491745557167492, 'mass_2_source': 1.5695643891968194, 's1_z': -0.01289339748028704, 's2_z': -0.044651974173985566, 'cos_iota': 0.9257954865629623, 'd_L': 311.156085325912, 't_c': 0.037336176501672064, 'phase_c': 1.7569304899532918, 'psi': 1.7793333821768123, 'ra': 2.9733450612264347, 'sin_dec': -0.9665144346691039, 'q': 0.8487919024975166, 'M_c': 1.586315919671747, 'eta': 0.2483277005522955, 'iota': Array(0.3876618, dtype=float64, weak_type=True), 'dec': Array(-1.31128088, dtype=float64, weak_type=True), 'lambda_1': 88.03177464613387, 'lambda_2': 259.28459924880275}
15:35 ninjax INFO    : The trial injection parameters are {'M_c': 1.586315919671747, 'eta': 0.2483277005522955, 's1_z': -0.01289339748028704, 's2_z': -0.044651974173985566, 'lambda_1': 88.03177464613387, 'lambda_2': 259.28459924880275, 'd_L': 311.156085325912, 'phase_c': 1.7569304899532918, 'iota': 0.3876618018938555, 't_c': 0.037336176501672064, 'psi': 1.7793333821768123, 'ra': 2.9733450612264347, 'dec': -1.3112808830563598}
15:35 ninjax INFO    : Injecting signals . . .
15:35 ninjax INFO    : self.ifos
15:35 ninjax INFO    : [GroundBased2G(H1), GroundBased2G(L1), GroundBased2G(V1)]
15:35 ninjax INFO    : Signal injected in ifo H1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
15:35 ninjax INFO    : [-5.94157012e-23-3.43646903e-23j -7.36258052e-23-5.28271430e-23j
 -3.86007263e-23+1.79510681e-23j ...
  5.39276585e-24+2.45612130e-24j  1.84029275e-23-8.43608813e-24j
  3.40736382e-24+7.17846548e-24j]
15:35 ninjax INFO    : [1.44906511e-46 1.44667215e-46 1.44435812e-46 ... 2.17775889e-47
 2.17777440e-47 2.17778992e-47]
15:35 ninjax INFO    : Signal injected in ifo L1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
15:35 ninjax INFO    : [ 1.94803467e-23-8.54461468e-23j -5.19550974e-23+3.64393238e-23j
  7.53772086e-24+6.25997895e-23j ...
  1.86703593e-23-1.85004586e-23j  2.39226751e-24+2.92689594e-23j
 -6.76490621e-24-1.27936854e-23j]
15:35 ninjax INFO    : [1.44906511e-46 1.44667215e-46 1.44435812e-46 ... 2.17775889e-47
 2.17777440e-47 2.17778992e-47]
15:35 ninjax INFO    : Signal injected in ifo V1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
15:35 ninjax INFO    : [-2.39496104e-23-1.04603050e-23j -3.10633434e-23+1.56568819e-23j
 -5.05252227e-23+3.44156940e-23j ...
  2.68093500e-23+9.93100511e-24j  5.52060823e-23-5.33113442e-24j
 -2.70040850e-23-1.64197721e-23j]
15:35 ninjax INFO    : [1.43183556e-46 1.42935095e-46 1.42688205e-46 ... 6.39786094e-47
 6.39790724e-47 6.39795354e-47]
15:35 ninjax INFO    : SNR for ifo H1 is 18.463437475520152
15:35 ninjax INFO    : SNR for ifo L1 is 14.41212775535172
15:35 ninjax INFO    : SNR for ifo V1 is 9.813282783654433
15:35 ninjax INFO    : The network SNR is 25.395048116532283
15:35 ninjax INFO    : The network SNR does not pass the threshold, trying again
15:35 ninjax INFO    : Generating new injection
15:35 ninjax INFO    : Sanity check: generated parameters:
15:35 ninjax INFO    : {'mass_1_source': 1.7588982153708106, 'mass_2_source': 1.9450640265843933, 's1_z': 0.03716642471626995, 's2_z': 0.04232359180752575, 'cos_iota': 0.6490225789400332, 'd_L': 320.46079077414925, 't_c': -0.07138392448580935, 'phase_c': 1.9771387293565537, 'psi': 0.3543742386911697, 'ra': 5.321992684808713, 'sin_dec': 0.14352218394778715}
15:35 ninjax INFO    : Computing lambdas from EOS file /home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/MPA1.npz . . . 
15:35 ninjax INFO    : Injected lambda_1: 60.731597936911825
15:35 ninjax INFO    : Injected lambda_2: 124.52176564481182
15:35 ninjax INFO    : Duration is not specified in the config. Computed chirp time: for fmin = 20.0 and M_c = 1.7263639867734817 is 128.0
15:35 ninjax INFO    : After transforms, the injection parameters are:
15:35 ninjax INFO    : {'mass_1_source': 1.9450640265843933, 'mass_2_source': 1.7588982153708106, 's1_z': 0.03716642471626995, 's2_z': 0.04232359180752575, 'cos_iota': 0.6490225789400332, 'd_L': 320.46079077414925, 't_c': -0.07138392448580935, 'phase_c': 1.9771387293565537, 'psi': 0.3543742386911697, 'ra': 5.321992684808713, 'sin_dec': 0.14352218394778715, 'q': 0.9042880806651404, 'M_c': 1.7263639867734817, 'eta': 0.24936845142263725, 'iota': Array(0.86449738, dtype=float64, weak_type=True), 'dec': Array(0.14401953, dtype=float64, weak_type=True), 'lambda_1': 60.731597936911825, 'lambda_2': 124.52176564481182}
15:35 ninjax INFO    : The trial injection parameters are {'M_c': 1.7263639867734817, 'eta': 0.24936845142263725, 's1_z': 0.03716642471626995, 's2_z': 0.04232359180752575, 'lambda_1': 60.731597936911825, 'lambda_2': 124.52176564481182, 'd_L': 320.46079077414925, 'phase_c': 1.9771387293565537, 'iota': 0.864497375399248, 't_c': -0.07138392448580935, 'psi': 0.3543742386911697, 'ra': 5.321992684808713, 'dec': 0.1440195344350933}
15:35 ninjax INFO    : Injecting signals . . .
15:35 ninjax INFO    : self.ifos
15:35 ninjax INFO    : [GroundBased2G(H1), GroundBased2G(L1), GroundBased2G(V1)]
15:35 ninjax INFO    : Signal injected in ifo H1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
15:35 ninjax INFO    : [-6.57136025e-23-3.91280660e-23j -8.09115225e-23-4.97715346e-23j
 -3.94887874e-23+2.60983769e-23j ...
  5.39265592e-24+2.45742964e-24j  1.84026852e-23-8.43479781e-24j
  3.40699156e-24+7.17972441e-24j]
15:35 ninjax INFO    : [1.44906511e-46 1.44667215e-46 1.44435812e-46 ... 2.17775889e-47
 2.17777440e-47 2.17778992e-47]
15:35 ninjax INFO    : Signal injected in ifo L1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
15:35 ninjax INFO    : [ 2.49590453e-23-7.91609639e-23j -4.57193107e-23+3.40574818e-23j
  8.21828367e-24+5.78317830e-23j ...
  1.86755012e-23-1.84986648e-23j  2.39720113e-24+2.92712641e-23j
 -6.76023149e-24-1.27908934e-23j]
15:35 ninjax INFO    : [1.44906511e-46 1.44667215e-46 1.44435812e-46 ... 2.17775889e-47
 2.17777440e-47 2.17778992e-47]
15:35 ninjax INFO    : Signal injected in ifo V1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
15:35 ninjax INFO    : [-2.93022618e-23-5.88907981e-24j -2.71601528e-23+2.34291107e-23j
 -4.13457020e-23+3.20220140e-23j ...
  2.68027867e-23+9.93361416e-24j  5.51992894e-23-5.32920260e-24j
 -2.70110380e-23-1.64185372e-23j]
15:35 ninjax INFO    : [1.43183556e-46 1.42935095e-46 1.42688205e-46 ... 6.39786094e-47
 6.39790724e-47 6.39795354e-47]
15:35 ninjax INFO    : SNR for ifo H1 is 1.514659186171881
15:35 ninjax INFO    : SNR for ifo L1 is 6.270164590830983
15:35 ninjax INFO    : SNR for ifo V1 is 6.416427171057706
15:35 ninjax INFO    : The network SNR is 9.098334687614713
15:35 ninjax INFO    : The network SNR does not pass the threshold, trying again
15:35 ninjax INFO    : Generating new injection
15:35 ninjax INFO    : Sanity check: generated parameters:
15:35 ninjax INFO    : {'mass_1_source': 1.523504137941885, 'mass_2_source': 2.0744491417153936, 's1_z': -0.0013851376577597857, 's2_z': 0.047131319739770514, 'cos_iota': 0.6934609109921555, 'd_L': 267.2251225526339, 't_c': 0.02191046058132544, 'phase_c': 4.6772528940582285, 'psi': 2.737199102357863, 'ra': 5.921824454808301, 'sin_dec': 0.6603076194996516}
15:35 ninjax INFO    : Computing lambdas from EOS file /home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/MPA1.npz . . . 
15:35 ninjax INFO    : Injected lambda_1: 36.296284765027984
15:35 ninjax INFO    : Injected lambda_2: 311.04090588290484
15:35 ninjax INFO    : Duration is not specified in the config. Computed chirp time: for fmin = 20.0 and M_c = 1.6371888392096543 is 128.0
15:35 ninjax INFO    : After transforms, the injection parameters are:
15:35 ninjax INFO    : {'mass_1_source': 2.0744491417153936, 'mass_2_source': 1.523504137941885, 's1_z': -0.0013851376577597857, 's2_z': 0.047131319739770514, 'cos_iota': 0.6934609109921555, 'd_L': 267.2251225526339, 't_c': 0.02191046058132544, 'phase_c': 4.6772528940582285, 'psi': 2.737199102357863, 'ra': 5.921824454808301, 'sin_dec': 0.6603076194996516, 'q': 0.7344138293417385, 'M_c': 1.6371888392096543, 'eta': 0.2441380046783948, 'iota': Array(0.80451479, dtype=float64, weak_type=True), 'dec': Array(0.7212283, dtype=float64, weak_type=True), 'lambda_1': 36.296284765027984, 'lambda_2': 311.04090588290484}
15:35 ninjax INFO    : The trial injection parameters are {'M_c': 1.6371888392096543, 'eta': 0.2441380046783948, 's1_z': -0.0013851376577597857, 's2_z': 0.047131319739770514, 'lambda_1': 36.296284765027984, 'lambda_2': 311.04090588290484, 'd_L': 267.2251225526339, 'phase_c': 4.6772528940582285, 'iota': 0.8045147853685994, 't_c': 0.02191046058132544, 'psi': 2.737199102357863, 'ra': 5.921824454808301, 'dec': 0.7212283029253577}
15:35 ninjax INFO    : Injecting signals . . .
15:35 ninjax INFO    : self.ifos
15:35 ninjax INFO    : [GroundBased2G(H1), GroundBased2G(L1), GroundBased2G(V1)]
15:35 ninjax INFO    : Signal injected in ifo H1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
15:35 ninjax INFO    : [-6.35243791e-23-3.31978889e-23j -7.45033946e-23-5.04145416e-23j
 -3.85855715e-23+1.95064384e-23j ...
  5.39276234e-24+2.45611913e-24j  1.84029243e-23-8.43609062e-24j
  3.40736080e-24+7.17846270e-24j]
15:35 ninjax INFO    : [1.44906511e-46 1.44667215e-46 1.44435812e-46 ... 2.17775889e-47
 2.17777440e-47 2.17778992e-47]
15:35 ninjax INFO    : Signal injected in ifo L1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
15:35 ninjax INFO    : [ 1.84585405e-23-8.01562868e-23j -4.69131550e-23+4.02579875e-23j
  1.38740522e-23+5.91379934e-23j ...
  1.86703625e-23-1.85004590e-23j  2.39227072e-24+2.92689593e-23j
 -6.76490301e-24-1.27936851e-23j]
15:35 ninjax INFO    : [1.44906511e-46 1.44667215e-46 1.44435812e-46 ... 2.17775889e-47
 2.17777440e-47 2.17778992e-47]
15:35 ninjax INFO    : Signal injected in ifo V1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.          20.0078125   20.015625  ... 2047.9765625
 2047.984375  2047.9921875]
15:35 ninjax INFO    : [-2.97137788e-23-3.46305719e-24j -2.63266155e-23+2.39494867e-23j
 -4.07748761e-23+3.28102985e-23j ...
  2.68093527e-23+9.93100495e-24j  5.52060851e-23-5.33113432e-24j
 -2.70040822e-23-1.64197717e-23j]
15:35 ninjax INFO    : [1.43183556e-46 1.42935095e-46 1.42688205e-46 ... 6.39786094e-47
 6.39790724e-47 6.39795354e-47]
15:35 ninjax INFO    : SNR for ifo H1 is 15.108356436357097
15:35 ninjax INFO    : SNR for ifo L1 is 7.979629048725311
15:35 ninjax INFO    : SNR for ifo V1 is 7.355192876183064
15:35 ninjax INFO    : The network SNR is 18.602036883339625
15:35 ninjax INFO    : The network SNR does not pass the threshold, trying again
15:35 ninjax INFO    : Generating new injection
15:35 ninjax INFO    : Sanity check: generated parameters:
15:35 ninjax INFO    : {'mass_1_source': 2.4235069716905304, 'mass_2_source': 2.2601264341574767, 's1_z': 0.019909299225870897, 's2_z': 0.005880442457957803, 'cos_iota': -0.9522194848900232, 'd_L': 265.4720455439534, 't_c': -0.049474345092509475, 'phase_c': 4.562087698449729, 'psi': 1.9434102496832764, 'ra': 0.09489042336140875, 'sin_dec': 0.48746899567437296}
15:35 ninjax INFO    : Computing lambdas from EOS file /home/twouters2/projects/projection_BNS_A_plus/src/projection_BNS/data/MPA1.npz . . . 
15:35 ninjax INFO    : Injected lambda_1: 6.167443250958857
15:35 ninjax INFO    : Injected lambda_2: 16.150406974795775
15:35 ninjax INFO    : Duration is not specified in the config. Computed chirp time: for fmin = 20.0 and M_c = 2.159381521613974 is 64.0
15:35 ninjax INFO    : After transforms, the injection parameters are:
15:35 ninjax INFO    : {'mass_1_source': 2.4235069716905304, 'mass_2_source': 2.2601264341574767, 's1_z': 0.019909299225870897, 's2_z': 0.005880442457957803, 'cos_iota': -0.9522194848900232, 'd_L': 265.4720455439534, 't_c': -0.049474345092509475, 'phase_c': 4.562087698449729, 'psi': 1.9434102496832764, 'ra': 0.09489042336140875, 'sin_dec': 0.48746899567437296, 'q': 0.9325850763205823, 'M_c': 2.159381521613974, 'eta': 0.24969578903763165, 'iota': Array(2.83121889, dtype=float64, weak_type=True), 'dec': Array(0.50918866, dtype=float64, weak_type=True), 'lambda_1': 6.167443250958857, 'lambda_2': 16.150406974795775}
15:35 ninjax INFO    : The trial injection parameters are {'M_c': 2.159381521613974, 'eta': 0.24969578903763165, 's1_z': 0.019909299225870897, 's2_z': 0.005880442457957803, 'lambda_1': 6.167443250958857, 'lambda_2': 16.150406974795775, 'd_L': 265.4720455439534, 'phase_c': 4.562087698449729, 'iota': 2.831218894364028, 't_c': -0.049474345092509475, 'psi': 1.9434102496832764, 'ra': 0.09489042336140875, 'dec': 0.5091886621983356}
15:35 ninjax INFO    : Injecting signals . . .
15:35 ninjax INFO    : self.ifos
15:35 ninjax INFO    : [GroundBased2G(H1), GroundBased2G(L1), GroundBased2G(V1)]
15:35 ninjax INFO    : Signal injected in ifo H1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.         20.015625   20.03125  ... 2047.953125 2047.96875
 2047.984375]
15:35 ninjax INFO    : [-1.68294320e-23-3.29411695e-24j -5.97244358e-23-1.76405923e-23j
 -2.79569677e-23+1.36112646e-23j ...
  1.42773158e-23-1.04455625e-23j  2.81701528e-23-1.49764981e-23j
 -3.59618439e-24+1.26969407e-23j]
15:35 ninjax INFO    : [1.44906511e-46 1.44435812e-46 1.43973008e-46 ... 2.17771234e-47
 2.17774337e-47 2.17777440e-47]
15:35 ninjax INFO    : Signal injected in ifo L1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.         20.015625   20.03125  ... 2047.953125 2047.96875
 2047.984375]
15:35 ninjax INFO    : [ 3.75315886e-24+1.74297608e-23j  3.10897214e-23+2.10936338e-23j
 -5.63334270e-23-6.18778230e-23j ...
 -6.75432929e-25+1.24482333e-23j -2.24032331e-24-1.59909854e-23j
 -2.14992332e-23-2.08552408e-23j]
15:35 ninjax INFO    : [1.44906511e-46 1.44435812e-46 1.43973008e-46 ... 2.17771234e-47
 2.17774337e-47 2.17777440e-47]
15:35 ninjax INFO    : Signal injected in ifo V1. Frequencies, data, and PSD:
15:35 ninjax INFO    : [  20.         20.015625   20.03125  ... 2047.953125 2047.96875
 2047.984375]
15:35 ninjax INFO    : [ 5.37513871e-23-1.26722862e-23j  1.72515337e-23+2.03118603e-24j
  5.45819746e-24+1.17491402e-23j ...
 -2.31610396e-23+3.59544444e-23j  3.26665170e-23+3.47947390e-23j
  6.10554798e-24+2.39560033e-23j]
15:35 ninjax INFO    : [1.43183556e-46 1.42688205e-46 1.42194425e-46 ... 6.39772204e-47
 6.39781464e-47 6.39790724e-47]
15:35 ninjax INFO    : SNR for ifo H1 is 29.93063404784746
15:35 ninjax INFO    : SNR for ifo L1 is 21.769462308892415
15:35 ninjax INFO    : SNR for ifo V1 is 8.05140462150519
15:35 ninjax INFO    : The network SNR is 37.875816296202096
15:35 ninjax INFO    : Network SNR passes threshold
15:35 ninjax INFO    : Sanity checking the GW injection for ArrayImpl
15:35 ninjax INFO    :    mass_1_source: 2.4235069716905304
15:35 ninjax INFO    :    mass_2_source: 2.2601264341574767
15:35 ninjax INFO    :    s1_z: 0.019909299225870897
15:35 ninjax INFO    :    s2_z: 0.005880442457957803
15:35 ninjax INFO    :    cos_iota: -0.9522194848900232
15:35 ninjax INFO    :    d_L: 265.4720455439534
15:35 ninjax INFO    :    t_c: -0.049474345092509475
15:35 ninjax INFO    :    phase_c: 4.562087698449729
15:35 ninjax INFO    :    psi: 1.9434102496832764
15:35 ninjax INFO    :    ra: 0.09489042336140875
15:35 ninjax INFO    :    sin_dec: 0.48746899567437296
15:35 ninjax INFO    :    q: 0.9325850763205823
15:35 ninjax INFO    :    M_c: 2.159381521613974
15:35 ninjax INFO    :    eta: 0.24969578903763165
15:35 ninjax INFO    :    iota: 2.831218894364028
15:35 ninjax INFO    :    dec: 0.5091886621983356
15:35 ninjax INFO    :    lambda_1: 6.167443250958857
15:35 ninjax INFO    :    lambda_2: 16.150406974795775
15:35 ninjax INFO    :    H1_SNR: 29.93063404784746
15:35 ninjax INFO    :    L1_SNR: 21.769462308892415
15:35 ninjax INFO    :    V1_SNR: 8.05140462150519
15:35 ninjax INFO    :    network_SNR: 37.875816296202096
15:35 ninjax INFO    :    epoch: 62.0
15:35 ninjax INFO    :    gmst: 2.7288901910520846
15:35 ninjax INFO    :    duration: 64.0
15:35 ninjax INFO    : Using GW HeterodynedTransientLikelihoodFD. Initializing likelihood
15:35 ninjax INFO    : Using the injection parameters as reference parameters for the relative binning
15:35 ninjax INFO    : Using the following kwargs for the GW likelihood: {}
